<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>SignalCliApi.signalSentMessage API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../SignalCliApi.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;SignalCliApi</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#SentMessage">SentMessage</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SentMessage.__init__">SentMessage</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.body">body</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.attachments">attachments</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.mentions">mentions</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.reactions">reactions</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.sticker">sticker</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.quote">quote</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.expiration">expiration</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.expiration_timestamp">expiration_timestamp</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.is_expired">is_expired</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.is_sent">is_sent</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.sent_to">sent_to</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.delivery_receipts">delivery_receipts</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.read_receipts">read_receipts</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.viewed_receipts">viewed_receipts</a>
                        </li>
                        <li>
                                <a class="variable" href="#SentMessage.preview">preview</a>
                        </li>
                        <li>
                                <a class="function" href="#SentMessage.get_quote">get_quote</a>
                        </li>
                        <li>
                                <a class="function" href="#SentMessage.parse_mentions">parse_mentions</a>
                        </li>
                        <li>
                                <a class="function" href="#SentMessage.react">react</a>
                        </li>
                        <li>
                                <a class="function" href="#SentMessage.reply">reply</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>Version 1.0</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../SignalCliApi.html">SignalCliApi</a><wbr>.signalSentMessage    </h1>

                        <div class="docstring"><p>File: signalSentMessage.py
Store and maintain a sent message.</p>
</div>

                        <input id="mod-signalSentMessage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-signalSentMessage-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">File: signalSentMessage.py</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">Store and maintain a sent message.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">logging</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">socket</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">.signalAttachment</span> <span class="kn">import</span> <span class="n">Attachment</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">.signalCommon</span> <span class="kn">import</span> <span class="n">__type_error__</span><span class="p">,</span> <span class="n">__socket_receive__</span><span class="p">,</span> <span class="n">__socket_send__</span><span class="p">,</span> <span class="n">UNKNOWN_DEVICE_NAME</span><span class="p">,</span> <span class="n">MessageTypes</span><span class="p">,</span>\
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="n">RecipientTypes</span><span class="p">,</span> <span class="n">ReceiptTypes</span><span class="p">,</span> <span class="n">__parse_signal_response__</span><span class="p">,</span> <span class="n">__check_response_for_error__</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">.signalContacts</span> <span class="kn">import</span> <span class="n">Contacts</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span> <span class="nn">.signalContact</span> <span class="kn">import</span> <span class="n">Contact</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">.signalDevices</span> <span class="kn">import</span> <span class="n">Devices</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">.signalDevice</span> <span class="kn">import</span> <span class="n">Device</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">.signalGroups</span> <span class="kn">import</span> <span class="n">Groups</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">.signalGroup</span> <span class="kn">import</span> <span class="n">Group</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span> <span class="nn">.signalMention</span> <span class="kn">import</span> <span class="n">Mention</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span> <span class="nn">.signalMentions</span> <span class="kn">import</span> <span class="n">Mentions</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span> <span class="nn">.signalMessage</span> <span class="kn">import</span> <span class="n">Message</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span> <span class="nn">.signalPreview</span> <span class="kn">import</span> <span class="n">Preview</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span> <span class="nn">.signalQuote</span> <span class="kn">import</span> <span class="n">Quote</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">from</span> <span class="nn">.signalReaction</span> <span class="kn">import</span> <span class="n">Reaction</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">from</span> <span class="nn">.signalReactions</span> <span class="kn">import</span> <span class="n">Reactions</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="kn">from</span> <span class="nn">.signalReceipt</span> <span class="kn">import</span> <span class="n">Receipt</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="kn">from</span> <span class="nn">.signalSticker</span> <span class="kn">import</span> <span class="n">Sticker</span><span class="p">,</span> <span class="n">StickerPacks</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="kn">from</span> <span class="nn">.signalTimestamp</span> <span class="kn">import</span> <span class="n">Timestamp</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="c1"># Define Self:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="n">Self</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;Self&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;SentMessage&quot;</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="k">class</span> <span class="nc">SentMessage</span><span class="p">(</span><span class="n">Message</span><span class="p">):</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    Class to store a sent message.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>                 <span class="n">command_socket</span><span class="p">:</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>                 <span class="n">account_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>                 <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>                 <span class="n">contacts</span><span class="p">:</span> <span class="n">Contacts</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>                 <span class="n">groups</span><span class="p">:</span> <span class="n">Groups</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>                 <span class="n">devices</span><span class="p">:</span> <span class="n">Devices</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>                 <span class="n">this_device</span><span class="p">:</span> <span class="n">Device</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>                 <span class="n">sticker_packs</span><span class="p">:</span> <span class="n">StickerPacks</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>                 <span class="n">from_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>                 <span class="n">raw_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>                 <span class="n">recipient</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Contact</span> <span class="o">|</span> <span class="n">Group</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>                 <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>                 <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>                 <span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]</span> <span class="o">|</span> <span class="n">Attachment</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>                 <span class="n">mentions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">|</span> <span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>                 <span class="n">reactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">|</span> <span class="n">Reactions</span> <span class="o">|</span> <span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>                 <span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>                 <span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quote</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>                 <span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>                 <span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>                 <span class="n">sent_to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Contact</span><span class="p">]</span> <span class="o">|</span> <span class="n">Contact</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>                 <span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Preview</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        Initialize a SentMessage object.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        :param command_socket: socket.socket: The socket to use for command operations.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        :param account_id: str: This accounts&#39; ID.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        :param config_path: str: The full path to signal-cli config directory.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        :param contacts: Contacts: This accounts&#39; Contacts object.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        :param groups: Groups: This accounts&#39; Groups object.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        :param devices: Devices: This accounts&#39; Devices object.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        :param this_device: Device: The Device object representing the device we&#39;re on.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        :param sticker_packs: StickerPacks: The loaded StickerPacks object.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        :param from_dict: Optional[dict[str, Any]]: The dict created by __to_dict__().</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        :param raw_message: Optional[dict[str, Any]]: The dict provided by signal.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        :param recipient: Optional[Contact | Group]: The recipient of this message.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        :param timestamp: Optional[Timestamp]: The timestamp of this message.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        :param body: Optional[str]: The body of this message.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        :param attachments: Optional[Iterable[Attachment] | Attachment]: Any attachments to this message.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        :param mentions: Optional[Iterable[Mention] | Mentions | Mention]: Any mentions in this message.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        :param reactions: Optional[Iterable[Reaction] | Reactions | Reaction]: Any reactions to this message.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        :param sticker: Optional[Sticker]: The sticker for this message.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        :param quote: Optional[Quote]: The quote this message contains.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        :param expiration: Optional[timedelta]: The expiration time in seconds as a timedelta.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        :param is_sent: bool: Is this message already sent?</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        :param sent_to: Optional[Iterable[Contact] | Contact]: The Contacts of the people this message was sent to, if</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">            the message was sent to a Group, the members of the group will show up here individually.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        :param preview: Optional[Preview]: Any URL preview this message contains.</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="c1"># Check sticker_packs:</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sticker_packs</span><span class="p">,</span> <span class="n">StickerPacks</span><span class="p">):</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sticker_packs&quot;</span><span class="p">,</span> <span class="s2">&quot;StickerPacks&quot;</span><span class="p">,</span> <span class="n">sticker_packs</span><span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="c1"># Check Body:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[str]&quot;</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="c1"># Check attachments:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="n">attachment_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="n">attachments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachments</span><span class="p">,</span> <span class="n">Attachment</span><span class="p">):</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                <span class="n">attachment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachments</span><span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachments</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attachments</span><span class="p">):</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span> <span class="n">Attachment</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;attachments[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Attachment&quot;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                    <span class="n">attachment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;attachments&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Attachment] | Attachment&quot;</span><span class="p">,</span> <span class="n">attachments</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="c1"># Check mentions:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">mentions_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="n">mentions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mentions</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                <span class="k">pass</span>  <span class="c1"># This is checked again later.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mention</span><span class="p">):</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                <span class="n">mentions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mentions</span><span class="p">)</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mention</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mentions</span><span class="p">):</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mention</span><span class="p">,</span> <span class="n">Mention</span><span class="p">):</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;mentions[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Mention&quot;</span><span class="p">,</span> <span class="n">mention</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                    <span class="n">mentions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mention</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;mentions&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Mention] | Mentions | Mention]&quot;</span><span class="p">,</span> <span class="n">mentions</span><span class="p">)</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="c1"># Check reactions:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="n">reaction_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="k">if</span> <span class="n">reactions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reactions</span><span class="p">):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>                <span class="k">pass</span>  <span class="c1"># This is checked again later.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                <span class="n">reaction_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reactions</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reactions</span><span class="p">):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s1">&#39;reactions[</span><span class="si">%i</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Reaction&quot;</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                    <span class="n">reaction_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;reactions&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Reaction] | Reactions | Reaction&quot;</span><span class="p">,</span> <span class="n">reactions</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="c1"># Check sticker:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="n">sticker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sticker</span><span class="p">,</span> <span class="n">Sticker</span><span class="p">):</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sticker&quot;</span><span class="p">,</span> <span class="s2">&quot;Sticker&quot;</span><span class="p">,</span> <span class="n">sticker</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="c1"># Check quote:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="n">quote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quote</span><span class="p">,</span> <span class="n">Quote</span><span class="p">):</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;quote&quot;</span><span class="p">,</span> <span class="s2">&quot;Quote&quot;</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="c1"># Check expiry:</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">if</span> <span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expiration</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">):</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;expiry&quot;</span><span class="p">,</span> <span class="s2">&quot;timedelta&quot;</span><span class="p">,</span> <span class="n">expiration</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="c1"># Check is_sent:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_sent</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;is_sent&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span> <span class="n">is_sent</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="c1"># Check sent_to:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="n">sent_to_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Contact</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">sent_to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_to</span><span class="p">,</span> <span class="n">Contact</span><span class="p">):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>                <span class="n">sent_to_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent_to</span><span class="p">]</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_to</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>                <span class="n">sent_to_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">contact</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sent_to_list</span><span class="p">):</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="n">Contact</span><span class="p">):</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sent_to[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Contact&quot;</span><span class="p">,</span> <span class="n">contact</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                    <span class="n">sent_to_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sent_to&quot;</span><span class="p">,</span> <span class="s2">&quot;Iterable[Contact] | Contact&quot;</span><span class="p">,</span> <span class="n">sent_to</span><span class="p">)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="c1"># Check previews:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="n">preview</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preview</span><span class="p">,</span> <span class="n">Preview</span><span class="p">):</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">,</span> <span class="s2">&quot;Preview&quot;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="c1"># Set internal vars:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span> <span class="o">=</span> <span class="n">sticker_packs</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded sticker packs object.&quot;&quot;&quot;</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="c1"># Set external properties:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="c1"># Set body:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The body of the message.&quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="c1"># Set Attachments:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]]</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any attachments to the message.&quot;&quot;&quot;</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attachment_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="n">attachment_list</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="c1"># Set mentions:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="p">:</span> <span class="n">Mentions</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any mentions in the message.&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mentions</span><span class="p">):</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">mentions</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">mentions_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">mentions</span><span class="o">=</span><span class="n">mentions_list</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="c1"># Set reactions:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span> <span class="n">Reactions</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any reactions to the message.&quot;&quot;&quot;</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reactions</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">reactions</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">reaction_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                                       <span class="n">this_device</span><span class="o">=</span><span class="n">this_device</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>                                       <span class="n">this_device</span><span class="o">=</span><span class="n">this_device</span><span class="p">,</span> <span class="n">reactions</span><span class="o">=</span><span class="n">reaction_list</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="c1"># Set sticker:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="n">sticker</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The sticker for this message.&quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="c1"># Set quote:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quote</span><span class="p">]</span> <span class="o">=</span> <span class="n">quote</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The quote this message contains.&quot;&quot;&quot;</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="c1"># Set expiry:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="n">expiration</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The expiration time of this message in seconds as a timedelta.&quot;&quot;&quot;</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp at which this message expires.&quot;&quot;&quot;</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is this message expired?&quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="c1"># Set is sent:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_sent</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Was this message sent?&quot;&quot;&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="c1"># Set sent_to:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Contact</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of Contacts of who this message has been sent to.&quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="n">sent_to_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="n">sent_to_list</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="c1"># Set delivery_receipts, read_receipts and viewed_receipts:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The delivery receipts for this message.&quot;&quot;&quot;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The read receipts for this message.&quot;&quot;&quot;</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The viewed receipts for this message.&quot;&quot;&quot;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="c1"># Set previews:</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="p">:</span> <span class="n">Preview</span> <span class="o">=</span> <span class="n">preview</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any URL previews for this message.&quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="c1"># Run super init:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="p">,</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>                         <span class="n">raw_message</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">get_self</span><span class="p">(),</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">this_device</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">MessageTypes</span><span class="o">.</span><span class="n">SENT</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="k">return</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="c1">##########################</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="c1"># Init:</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="c1">##########################</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="k">def</span> <span class="nf">__from_raw_message__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_message</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        Load from a dict provided by Signal.</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        :param raw_message: dict[str, Any]: The dict to load from.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        :return: None</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="c1"># super().__from_raw_message__(raw_message)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="c1"># Set raw message dict:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="n">raw_sent_message</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_message</span><span class="p">[</span><span class="s1">&#39;sync_message&#39;</span><span class="p">][</span><span class="s1">&#39;sentMessage&#39;</span><span class="p">]</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="c1"># Load recipient and recipient type:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;destination&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">=</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;destinationNumber&#39;</span><span class="p">],</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                                                                  <span class="n">uuid</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;destinationUuid&#39;</span><span class="p">])</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="k">elif</span> <span class="s1">&#39;groupInfo&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">=</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">group_id</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;groupInfo&#39;</span><span class="p">][</span><span class="s1">&#39;groupId&#39;</span><span class="p">])</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="c1"># Load timestamp:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">timestamp</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="c1"># Load Device:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">device_id</span><span class="o">=</span><span class="n">raw_message</span><span class="p">[</span><span class="s1">&#39;sourceDevice&#39;</span><span class="p">])</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="c1"># Load body:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="c1"># Load attachments:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="k">if</span> <span class="s1">&#39;attachments&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>            <span class="k">for</span> <span class="n">raw_attachment</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Attachment</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">raw_attachment</span><span class="o">=</span><span class="n">raw_attachment</span><span class="p">))</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="c1"># Load sticker:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="k">if</span> <span class="s1">&#39;sticker&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span><span class="o">.</span><span class="n">get_sticker</span><span class="p">(</span><span class="n">pack_id</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">][</span><span class="s1">&#39;pack_id&#39;</span><span class="p">],</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                                                           <span class="n">sticker_id</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">][</span><span class="s1">&#39;sticker_id&#39;</span><span class="p">])</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="c1"># Load mentions:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="s1">&#39;mentions&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">raw_mentions</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">])</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="c1"># Load quote:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="k">if</span> <span class="s1">&#39;quote&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                               <span class="n">raw_quote</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">])</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="c1"># Load expiry:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;expiresInSeconds&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;expiresInSeconds&#39;</span><span class="p">])</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="c1"># Load preview:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preview</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="k">if</span> <span class="s1">&#39;preview&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">preview</span> <span class="o">=</span> <span class="n">Preview</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">raw_preview</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;preview&#39;</span><span class="p">])</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="c1"># Set sent, since this is coming from a sync message.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="c1"># Set sent to, if a group, assume sent to all current members.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>            <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>        <span class="k">return</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>    <span class="c1">###########################</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>    <span class="c1"># To / From Dict:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>    <span class="c1">###########################</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>    <span class="k">def</span> <span class="nf">__to_dict__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">        Create a JSON friendly dict to store this sent message in.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">        :return: dict[str, Any]: A dict to provide to __from_dict__().</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="c1"># Call super:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="n">sent_message_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="c1"># Set body:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="c1"># Set attachments:</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s2">&quot;attachments&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>            <span class="k">for</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="p">:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                <span class="n">sent_message_dict</span><span class="p">[</span><span class="s2">&quot;attachments&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="c1"># Set Mentions:</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="c1"># Set Reactions:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="c1"># Set sticker:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                <span class="s1">&#39;packId&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="o">.</span><span class="n">pack_id</span><span class="p">,</span>  <span class="c1"># String</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                <span class="s1">&#39;stickerId&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="o">.</span><span class="n">id</span>  <span class="c1"># Integer</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="p">}</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="c1"># Set quote:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="c1"># Set expiration:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span><span class="o">.</span><span class="n">seconds</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>        <span class="c1"># Set expiration timestamp:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="c1"># Set is expired:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;isExpired&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="c1"># Set is sent:</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;isSent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="c1"># Set sent_to list:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="c1"># Set delivery_receipts list:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;deliveryReceipts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="k">for</span> <span class="n">receipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="p">:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;deliveryReceipts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="c1"># Set read_receipts list:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;readReceipts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="k">for</span> <span class="n">receipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="p">:</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;readReceipts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="c1"># Set viewed_receipts list:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;viewedReceipts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="k">for</span> <span class="n">receipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="p">:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;viewedReceipts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="c1"># Return Resulting dict:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="k">return</span> <span class="n">sent_message_dict</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">__from_dict__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__from_dict__</span><span class="p">(</span><span class="n">from_dict</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="c1"># Load Body:</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="c1"># Load attachments:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="k">for</span> <span class="n">attachmentDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]:</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>                <span class="n">attachment</span> <span class="o">=</span> <span class="n">Attachment</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">attachmentDict</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>        <span class="c1"># Load mentions:</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">])</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="c1"># Load reactions:</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                                       <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span> <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                                       <span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">])</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="c1"># Load sticker</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="n">sticker_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span><span class="o">.</span><span class="n">get_sticker</span><span class="p">(</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                <span class="n">pack_id</span><span class="o">=</span><span class="n">sticker_dict</span><span class="p">[</span><span class="s1">&#39;packId&#39;</span><span class="p">],</span>  <span class="c1"># String</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                <span class="n">sticker_id</span><span class="o">=</span><span class="n">sticker_dict</span><span class="p">[</span><span class="s1">&#39;stickerId&#39;</span><span class="p">]</span>  <span class="c1"># Integer</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>            <span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="c1"># Load Quote:</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">])</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="c1"># Load expiration:</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">])</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>        <span class="c1"># Load expiration timestamp:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">])</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="c1"># Load is expired:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;isExpired&#39;</span><span class="p">]</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>        <span class="c1"># Load is_sent:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;isSent&#39;</span><span class="p">]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="c1"># Load sent_to:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="k">for</span> <span class="n">contact_id</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                <span class="n">_</span><span class="p">,</span> <span class="n">contact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">contact_id</span><span class="o">=</span><span class="n">contact_id</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="c1"># Load delivery_receipts:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="k">for</span> <span class="n">receiptDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;deliveryReceipts&#39;</span><span class="p">]:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>            <span class="n">receipt</span> <span class="o">=</span> <span class="n">Receipt</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>                              <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>                              <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                              <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">receiptDict</span><span class="p">)</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>        <span class="c1"># Load read_receipts:</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>        <span class="k">for</span> <span class="n">receiptDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;readReceipts&#39;</span><span class="p">]:</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>            <span class="n">receipt</span> <span class="o">=</span> <span class="n">Receipt</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                              <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                              <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>                              <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">receiptDict</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>        <span class="c1"># Load viewed_receipts:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="k">for</span> <span class="n">receiptDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;viewedReceipts&#39;</span><span class="p">]:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>            <span class="n">receipt</span> <span class="o">=</span> <span class="n">Receipt</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>                              <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                              <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                              <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">receiptDict</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="k">return</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>    <span class="c1">###########################</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>    <span class="c1"># Helpers:</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>    <span class="c1">###########################</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>    <span class="k">def</span> <span class="nf">__parse_receipt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receipt</span><span class="p">:</span> <span class="n">Receipt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        Parse a receipt message, storing it in the right list, and acting on it.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">        :param receipt: Receipt: The receipt to parse.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        :return:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parse_receipt__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="c1"># Parse the receipt based on type:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="k">if</span> <span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span> <span class="o">==</span> <span class="n">ReceiptTypes</span><span class="o">.</span><span class="n">DELIVER</span><span class="p">:</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mark_delivered</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">when</span><span class="p">)</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="k">elif</span> <span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span> <span class="o">==</span> <span class="n">ReceiptTypes</span><span class="o">.</span><span class="n">READ</span><span class="p">:</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mark_read</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">when</span><span class="p">)</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">elif</span> <span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span> <span class="o">==</span> <span class="n">ReceiptTypes</span><span class="o">.</span><span class="n">VIEWED</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mark_viewed</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">when</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;invalid receipt type, cannot parse: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span><span class="p">)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising RuntimeError(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="k">return</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>    <span class="k">def</span> <span class="nf">__set_expiry__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_opened</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">        Set the expiration datetime object.</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">        :param time_opened: Timestamp: The time the message was opened.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">        :return: None</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>            <span class="n">expiry_datetime</span> <span class="o">=</span> <span class="n">time_opened</span><span class="o">.</span><span class="n">datetime</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">datetime_obj</span><span class="o">=</span><span class="n">expiry_datetime</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="k">return</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>    <span class="c1">###########################</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>    <span class="c1"># Methods:</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>    <span class="c1">###########################</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>    <span class="c1"># def mark_delivered(self, when: Optional[Timestamp] = None) -&gt; None:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>    <span class="c1">#     Mark this message as delivered.</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>    <span class="c1">#     :param when: Optional[Timestamp]: The timestamp for when this was delivered; If None, NOW is used.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>    <span class="c1">#     :return: None</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    <span class="c1">#     return super().mark_delivered(when)</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>    <span class="c1">#</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>    <span class="c1"># def mark_read(self, when: Optional[Timestamp] = None) -&gt; None:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>    <span class="c1">#     Mark this message as read.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>    <span class="c1">#     :param when: Optional[Timestamp]: The timestamp for when this was read; If None, NOW is used.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>    <span class="c1">#     :return: None</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>    <span class="c1">#     return super().mark_read(when)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>    <span class="c1">#</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>    <span class="c1"># def mark_viewed(self, when: Optional[Timestamp] = None) -&gt; None:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>    <span class="c1">#     Mark this message as viewed.</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>    <span class="c1">#     :param when: Optional[Timestamp]: The timestamp for when this was viewed; If None, NOW is used.</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>    <span class="c1">#     :return: None</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>    <span class="c1">#     return super().mark_viewed(when)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>    <span class="k">def</span> <span class="nf">get_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Quote</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        Get a quote object for this message.</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        :return: Quote: This message as a Quote object.</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>                      <span class="n">timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">mentions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="p">,</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>                      <span class="n">conversation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="k">return</span> <span class="n">quote</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>    <span class="k">def</span> <span class="nf">parse_mentions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        Parse mentions in this message.</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        :return: str: The body with mentions parsed; If &#39;mentions&#39; is None, the original body is returned.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="o">.</span><span class="n">__parse_mentions__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>    <span class="k">def</span> <span class="nf">react</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emoji</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Reaction</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        Send a reaction to this message.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">        :param emoji: str: The emoji to react with.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">        :return: tuple[bool, Reaction | str]: The first element is a bool which is either True or False on success or</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">            failure.</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a><span class="sd">            The second element is either the Reaction object on success, or a string with an error message on failure.</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">react</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>        <span class="c1"># Type check emoji:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s1">&#39;emoji&#39;</span><span class="p">,</span> <span class="s2">&quot;str, len = 1 or 2&quot;</span><span class="p">,</span> <span class="n">emoji</span><span class="p">)</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>        <span class="c1"># Value check emoji:</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">emoji</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;emoji must be str of len 1 -&gt; 4&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising ValueError(</span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>        <span class="c1"># Create reaction</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span><span class="p">:</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>            <span class="n">reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>                                <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>                                <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>                                <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">recipient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>                                <span class="n">target_author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>                                <span class="n">target_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span><span class="p">:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>            <span class="n">reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>                                <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>                                <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>                                <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">recipient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>                                <span class="n">target_author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">target_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Invalid recipient type.&quot;</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_message</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>        <span class="c1"># Send reaction:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>        <span class="n">sent</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sent</span><span class="p">:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">message</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>        <span class="c1"># Parse reaction:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>        <span class="n">parsed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">__parse__</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">parsed</span><span class="p">:</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;failed to parse reaction.&quot;</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising RuntimeError(</span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="c1"># Return success:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">reaction</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>    <span class="k">def</span> <span class="nf">reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>              <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>              <span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Attachment</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Attachment</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>              <span class="n">mentions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">|</span> <span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>              <span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>              <span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Preview</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Contact</span> <span class="o">|</span> <span class="n">Group</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Self</span><span class="p">],</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a><span class="sd">        Send a reply to this message.</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a><span class="sd">        :param body: str: The body to reply with.</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a><span class="sd">        :param attachments: Optional[Iterable[Attachment | str] | Attachment | str]: Any attachments to the message.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a><span class="sd">        :param mentions: Optional[Iterable[Mention] | Mentions | Mention]: Any mentions in this message.</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a><span class="sd">        :param sticker: Optional[Sticker]: The sticker to send as a message.</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a><span class="sd">        :param preview: Optional[Preview]: Any URL preview for this message.</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a><span class="sd">        :return: tuple[tuple[bool, Contact | Group, str | SentMessage], ...]: A tuple of tuples. One inner tuple per</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a><span class="sd">            recipient of the message.</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a><span class="sd">            The first element of the inner tuple is a bool which is True or False on success or failure.</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a><span class="sd">            The second element of the inner tuple is the Contact or Group that this message was sent to.</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a><span class="sd">            The third element of the inner tuple is either the SentMessage object on success or an error message on</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="sd">            failure.</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="SentMessage">
                            <input id="SentMessage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SentMessage</span><wbr>(<span class="base"><a href="signalMessage.html#Message">SignalCliApi.signalMessage.Message</a></span>):

                <label class="view-source-button" for="SentMessage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SentMessage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SentMessage-35"><a href="#SentMessage-35"><span class="linenos"> 35</span></a><span class="k">class</span> <span class="nc">SentMessage</span><span class="p">(</span><span class="n">Message</span><span class="p">):</span>
</span><span id="SentMessage-36"><a href="#SentMessage-36"><span class="linenos"> 36</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-37"><a href="#SentMessage-37"><span class="linenos"> 37</span></a><span class="sd">    Class to store a sent message.</span>
</span><span id="SentMessage-38"><a href="#SentMessage-38"><span class="linenos"> 38</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SentMessage-39"><a href="#SentMessage-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SentMessage-40"><a href="#SentMessage-40"><span class="linenos"> 40</span></a>                 <span class="n">command_socket</span><span class="p">:</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">,</span>
</span><span id="SentMessage-41"><a href="#SentMessage-41"><span class="linenos"> 41</span></a>                 <span class="n">account_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="SentMessage-42"><a href="#SentMessage-42"><span class="linenos"> 42</span></a>                 <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="SentMessage-43"><a href="#SentMessage-43"><span class="linenos"> 43</span></a>                 <span class="n">contacts</span><span class="p">:</span> <span class="n">Contacts</span><span class="p">,</span>
</span><span id="SentMessage-44"><a href="#SentMessage-44"><span class="linenos"> 44</span></a>                 <span class="n">groups</span><span class="p">:</span> <span class="n">Groups</span><span class="p">,</span>
</span><span id="SentMessage-45"><a href="#SentMessage-45"><span class="linenos"> 45</span></a>                 <span class="n">devices</span><span class="p">:</span> <span class="n">Devices</span><span class="p">,</span>
</span><span id="SentMessage-46"><a href="#SentMessage-46"><span class="linenos"> 46</span></a>                 <span class="n">this_device</span><span class="p">:</span> <span class="n">Device</span><span class="p">,</span>
</span><span id="SentMessage-47"><a href="#SentMessage-47"><span class="linenos"> 47</span></a>                 <span class="n">sticker_packs</span><span class="p">:</span> <span class="n">StickerPacks</span><span class="p">,</span>
</span><span id="SentMessage-48"><a href="#SentMessage-48"><span class="linenos"> 48</span></a>                 <span class="n">from_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-49"><a href="#SentMessage-49"><span class="linenos"> 49</span></a>                 <span class="n">raw_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-50"><a href="#SentMessage-50"><span class="linenos"> 50</span></a>                 <span class="n">recipient</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Contact</span> <span class="o">|</span> <span class="n">Group</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-51"><a href="#SentMessage-51"><span class="linenos"> 51</span></a>                 <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-52"><a href="#SentMessage-52"><span class="linenos"> 52</span></a>                 <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-53"><a href="#SentMessage-53"><span class="linenos"> 53</span></a>                 <span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]</span> <span class="o">|</span> <span class="n">Attachment</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-54"><a href="#SentMessage-54"><span class="linenos"> 54</span></a>                 <span class="n">mentions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">|</span> <span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-55"><a href="#SentMessage-55"><span class="linenos"> 55</span></a>                 <span class="n">reactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">|</span> <span class="n">Reactions</span> <span class="o">|</span> <span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-56"><a href="#SentMessage-56"><span class="linenos"> 56</span></a>                 <span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-57"><a href="#SentMessage-57"><span class="linenos"> 57</span></a>                 <span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quote</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-58"><a href="#SentMessage-58"><span class="linenos"> 58</span></a>                 <span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-59"><a href="#SentMessage-59"><span class="linenos"> 59</span></a>                 <span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="SentMessage-60"><a href="#SentMessage-60"><span class="linenos"> 60</span></a>                 <span class="n">sent_to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Contact</span><span class="p">]</span> <span class="o">|</span> <span class="n">Contact</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-61"><a href="#SentMessage-61"><span class="linenos"> 61</span></a>                 <span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Preview</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-62"><a href="#SentMessage-62"><span class="linenos"> 62</span></a>                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-63"><a href="#SentMessage-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-64"><a href="#SentMessage-64"><span class="linenos"> 64</span></a><span class="sd">        Initialize a SentMessage object.</span>
</span><span id="SentMessage-65"><a href="#SentMessage-65"><span class="linenos"> 65</span></a><span class="sd">        :param command_socket: socket.socket: The socket to use for command operations.</span>
</span><span id="SentMessage-66"><a href="#SentMessage-66"><span class="linenos"> 66</span></a><span class="sd">        :param account_id: str: This accounts&#39; ID.</span>
</span><span id="SentMessage-67"><a href="#SentMessage-67"><span class="linenos"> 67</span></a><span class="sd">        :param config_path: str: The full path to signal-cli config directory.</span>
</span><span id="SentMessage-68"><a href="#SentMessage-68"><span class="linenos"> 68</span></a><span class="sd">        :param contacts: Contacts: This accounts&#39; Contacts object.</span>
</span><span id="SentMessage-69"><a href="#SentMessage-69"><span class="linenos"> 69</span></a><span class="sd">        :param groups: Groups: This accounts&#39; Groups object.</span>
</span><span id="SentMessage-70"><a href="#SentMessage-70"><span class="linenos"> 70</span></a><span class="sd">        :param devices: Devices: This accounts&#39; Devices object.</span>
</span><span id="SentMessage-71"><a href="#SentMessage-71"><span class="linenos"> 71</span></a><span class="sd">        :param this_device: Device: The Device object representing the device we&#39;re on.</span>
</span><span id="SentMessage-72"><a href="#SentMessage-72"><span class="linenos"> 72</span></a><span class="sd">        :param sticker_packs: StickerPacks: The loaded StickerPacks object.</span>
</span><span id="SentMessage-73"><a href="#SentMessage-73"><span class="linenos"> 73</span></a><span class="sd">        :param from_dict: Optional[dict[str, Any]]: The dict created by __to_dict__().</span>
</span><span id="SentMessage-74"><a href="#SentMessage-74"><span class="linenos"> 74</span></a><span class="sd">        :param raw_message: Optional[dict[str, Any]]: The dict provided by signal.</span>
</span><span id="SentMessage-75"><a href="#SentMessage-75"><span class="linenos"> 75</span></a><span class="sd">        :param recipient: Optional[Contact | Group]: The recipient of this message.</span>
</span><span id="SentMessage-76"><a href="#SentMessage-76"><span class="linenos"> 76</span></a><span class="sd">        :param timestamp: Optional[Timestamp]: The timestamp of this message.</span>
</span><span id="SentMessage-77"><a href="#SentMessage-77"><span class="linenos"> 77</span></a><span class="sd">        :param body: Optional[str]: The body of this message.</span>
</span><span id="SentMessage-78"><a href="#SentMessage-78"><span class="linenos"> 78</span></a><span class="sd">        :param attachments: Optional[Iterable[Attachment] | Attachment]: Any attachments to this message.</span>
</span><span id="SentMessage-79"><a href="#SentMessage-79"><span class="linenos"> 79</span></a><span class="sd">        :param mentions: Optional[Iterable[Mention] | Mentions | Mention]: Any mentions in this message.</span>
</span><span id="SentMessage-80"><a href="#SentMessage-80"><span class="linenos"> 80</span></a><span class="sd">        :param reactions: Optional[Iterable[Reaction] | Reactions | Reaction]: Any reactions to this message.</span>
</span><span id="SentMessage-81"><a href="#SentMessage-81"><span class="linenos"> 81</span></a><span class="sd">        :param sticker: Optional[Sticker]: The sticker for this message.</span>
</span><span id="SentMessage-82"><a href="#SentMessage-82"><span class="linenos"> 82</span></a><span class="sd">        :param quote: Optional[Quote]: The quote this message contains.</span>
</span><span id="SentMessage-83"><a href="#SentMessage-83"><span class="linenos"> 83</span></a><span class="sd">        :param expiration: Optional[timedelta]: The expiration time in seconds as a timedelta.</span>
</span><span id="SentMessage-84"><a href="#SentMessage-84"><span class="linenos"> 84</span></a><span class="sd">        :param is_sent: bool: Is this message already sent?</span>
</span><span id="SentMessage-85"><a href="#SentMessage-85"><span class="linenos"> 85</span></a><span class="sd">        :param sent_to: Optional[Iterable[Contact] | Contact]: The Contacts of the people this message was sent to, if</span>
</span><span id="SentMessage-86"><a href="#SentMessage-86"><span class="linenos"> 86</span></a><span class="sd">            the message was sent to a Group, the members of the group will show up here individually.</span>
</span><span id="SentMessage-87"><a href="#SentMessage-87"><span class="linenos"> 87</span></a><span class="sd">        :param preview: Optional[Preview]: Any URL preview this message contains.</span>
</span><span id="SentMessage-88"><a href="#SentMessage-88"><span class="linenos"> 88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-89"><a href="#SentMessage-89"><span class="linenos"> 89</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="SentMessage-90"><a href="#SentMessage-90"><span class="linenos"> 90</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="SentMessage-91"><a href="#SentMessage-91"><span class="linenos"> 91</span></a>
</span><span id="SentMessage-92"><a href="#SentMessage-92"><span class="linenos"> 92</span></a>        <span class="c1"># Check sticker_packs:</span>
</span><span id="SentMessage-93"><a href="#SentMessage-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sticker_packs</span><span class="p">,</span> <span class="n">StickerPacks</span><span class="p">):</span>
</span><span id="SentMessage-94"><a href="#SentMessage-94"><span class="linenos"> 94</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-95"><a href="#SentMessage-95"><span class="linenos"> 95</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sticker_packs&quot;</span><span class="p">,</span> <span class="s2">&quot;StickerPacks&quot;</span><span class="p">,</span> <span class="n">sticker_packs</span><span class="p">)</span>
</span><span id="SentMessage-96"><a href="#SentMessage-96"><span class="linenos"> 96</span></a>
</span><span id="SentMessage-97"><a href="#SentMessage-97"><span class="linenos"> 97</span></a>        <span class="c1"># Check Body:</span>
</span><span id="SentMessage-98"><a href="#SentMessage-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SentMessage-99"><a href="#SentMessage-99"><span class="linenos"> 99</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-100"><a href="#SentMessage-100"><span class="linenos">100</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[str]&quot;</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</span><span id="SentMessage-101"><a href="#SentMessage-101"><span class="linenos">101</span></a>
</span><span id="SentMessage-102"><a href="#SentMessage-102"><span class="linenos">102</span></a>        <span class="c1"># Check attachments:</span>
</span><span id="SentMessage-103"><a href="#SentMessage-103"><span class="linenos">103</span></a>        <span class="n">attachment_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-104"><a href="#SentMessage-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="n">attachments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-105"><a href="#SentMessage-105"><span class="linenos">105</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachments</span><span class="p">,</span> <span class="n">Attachment</span><span class="p">):</span>
</span><span id="SentMessage-106"><a href="#SentMessage-106"><span class="linenos">106</span></a>                <span class="n">attachment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachments</span><span class="p">)</span>
</span><span id="SentMessage-107"><a href="#SentMessage-107"><span class="linenos">107</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachments</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage-108"><a href="#SentMessage-108"><span class="linenos">108</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attachments</span><span class="p">):</span>
</span><span id="SentMessage-109"><a href="#SentMessage-109"><span class="linenos">109</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span> <span class="n">Attachment</span><span class="p">):</span>
</span><span id="SentMessage-110"><a href="#SentMessage-110"><span class="linenos">110</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-111"><a href="#SentMessage-111"><span class="linenos">111</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;attachments[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Attachment&quot;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">)</span>
</span><span id="SentMessage-112"><a href="#SentMessage-112"><span class="linenos">112</span></a>                    <span class="n">attachment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
</span><span id="SentMessage-113"><a href="#SentMessage-113"><span class="linenos">113</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-114"><a href="#SentMessage-114"><span class="linenos">114</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-115"><a href="#SentMessage-115"><span class="linenos">115</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;attachments&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Attachment] | Attachment&quot;</span><span class="p">,</span> <span class="n">attachments</span><span class="p">)</span>
</span><span id="SentMessage-116"><a href="#SentMessage-116"><span class="linenos">116</span></a>
</span><span id="SentMessage-117"><a href="#SentMessage-117"><span class="linenos">117</span></a>        <span class="c1"># Check mentions:</span>
</span><span id="SentMessage-118"><a href="#SentMessage-118"><span class="linenos">118</span></a>        <span class="n">mentions_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-119"><a href="#SentMessage-119"><span class="linenos">119</span></a>        <span class="k">if</span> <span class="n">mentions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-120"><a href="#SentMessage-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mentions</span><span class="p">):</span>
</span><span id="SentMessage-121"><a href="#SentMessage-121"><span class="linenos">121</span></a>                <span class="k">pass</span>  <span class="c1"># This is checked again later.</span>
</span><span id="SentMessage-122"><a href="#SentMessage-122"><span class="linenos">122</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mention</span><span class="p">):</span>
</span><span id="SentMessage-123"><a href="#SentMessage-123"><span class="linenos">123</span></a>                <span class="n">mentions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mentions</span><span class="p">)</span>
</span><span id="SentMessage-124"><a href="#SentMessage-124"><span class="linenos">124</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage-125"><a href="#SentMessage-125"><span class="linenos">125</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mention</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mentions</span><span class="p">):</span>
</span><span id="SentMessage-126"><a href="#SentMessage-126"><span class="linenos">126</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mention</span><span class="p">,</span> <span class="n">Mention</span><span class="p">):</span>
</span><span id="SentMessage-127"><a href="#SentMessage-127"><span class="linenos">127</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-128"><a href="#SentMessage-128"><span class="linenos">128</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;mentions[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Mention&quot;</span><span class="p">,</span> <span class="n">mention</span><span class="p">)</span>
</span><span id="SentMessage-129"><a href="#SentMessage-129"><span class="linenos">129</span></a>                    <span class="n">mentions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mention</span><span class="p">)</span>
</span><span id="SentMessage-130"><a href="#SentMessage-130"><span class="linenos">130</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-131"><a href="#SentMessage-131"><span class="linenos">131</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-132"><a href="#SentMessage-132"><span class="linenos">132</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;mentions&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Mention] | Mentions | Mention]&quot;</span><span class="p">,</span> <span class="n">mentions</span><span class="p">)</span>
</span><span id="SentMessage-133"><a href="#SentMessage-133"><span class="linenos">133</span></a>
</span><span id="SentMessage-134"><a href="#SentMessage-134"><span class="linenos">134</span></a>        <span class="c1"># Check reactions:</span>
</span><span id="SentMessage-135"><a href="#SentMessage-135"><span class="linenos">135</span></a>        <span class="n">reaction_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-136"><a href="#SentMessage-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="n">reactions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-137"><a href="#SentMessage-137"><span class="linenos">137</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reactions</span><span class="p">):</span>
</span><span id="SentMessage-138"><a href="#SentMessage-138"><span class="linenos">138</span></a>                <span class="k">pass</span>  <span class="c1"># This is checked again later.</span>
</span><span id="SentMessage-139"><a href="#SentMessage-139"><span class="linenos">139</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
</span><span id="SentMessage-140"><a href="#SentMessage-140"><span class="linenos">140</span></a>                <span class="n">reaction_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reactions</span><span class="p">)</span>
</span><span id="SentMessage-141"><a href="#SentMessage-141"><span class="linenos">141</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage-142"><a href="#SentMessage-142"><span class="linenos">142</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reactions</span><span class="p">):</span>
</span><span id="SentMessage-143"><a href="#SentMessage-143"><span class="linenos">143</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
</span><span id="SentMessage-144"><a href="#SentMessage-144"><span class="linenos">144</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-145"><a href="#SentMessage-145"><span class="linenos">145</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s1">&#39;reactions[</span><span class="si">%i</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Reaction&quot;</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
</span><span id="SentMessage-146"><a href="#SentMessage-146"><span class="linenos">146</span></a>                    <span class="n">reaction_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</span><span id="SentMessage-147"><a href="#SentMessage-147"><span class="linenos">147</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-148"><a href="#SentMessage-148"><span class="linenos">148</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-149"><a href="#SentMessage-149"><span class="linenos">149</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;reactions&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Reaction] | Reactions | Reaction&quot;</span><span class="p">,</span> <span class="n">reactions</span><span class="p">)</span>
</span><span id="SentMessage-150"><a href="#SentMessage-150"><span class="linenos">150</span></a>
</span><span id="SentMessage-151"><a href="#SentMessage-151"><span class="linenos">151</span></a>        <span class="c1"># Check sticker:</span>
</span><span id="SentMessage-152"><a href="#SentMessage-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">sticker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sticker</span><span class="p">,</span> <span class="n">Sticker</span><span class="p">):</span>
</span><span id="SentMessage-153"><a href="#SentMessage-153"><span class="linenos">153</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-154"><a href="#SentMessage-154"><span class="linenos">154</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sticker&quot;</span><span class="p">,</span> <span class="s2">&quot;Sticker&quot;</span><span class="p">,</span> <span class="n">sticker</span><span class="p">)</span>
</span><span id="SentMessage-155"><a href="#SentMessage-155"><span class="linenos">155</span></a>
</span><span id="SentMessage-156"><a href="#SentMessage-156"><span class="linenos">156</span></a>        <span class="c1"># Check quote:</span>
</span><span id="SentMessage-157"><a href="#SentMessage-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">quote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quote</span><span class="p">,</span> <span class="n">Quote</span><span class="p">):</span>
</span><span id="SentMessage-158"><a href="#SentMessage-158"><span class="linenos">158</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-159"><a href="#SentMessage-159"><span class="linenos">159</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;quote&quot;</span><span class="p">,</span> <span class="s2">&quot;Quote&quot;</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>
</span><span id="SentMessage-160"><a href="#SentMessage-160"><span class="linenos">160</span></a>
</span><span id="SentMessage-161"><a href="#SentMessage-161"><span class="linenos">161</span></a>        <span class="c1"># Check expiry:</span>
</span><span id="SentMessage-162"><a href="#SentMessage-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-163"><a href="#SentMessage-163"><span class="linenos">163</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expiration</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">):</span>
</span><span id="SentMessage-164"><a href="#SentMessage-164"><span class="linenos">164</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-165"><a href="#SentMessage-165"><span class="linenos">165</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;expiry&quot;</span><span class="p">,</span> <span class="s2">&quot;timedelta&quot;</span><span class="p">,</span> <span class="n">expiration</span><span class="p">)</span>
</span><span id="SentMessage-166"><a href="#SentMessage-166"><span class="linenos">166</span></a>
</span><span id="SentMessage-167"><a href="#SentMessage-167"><span class="linenos">167</span></a>        <span class="c1"># Check is_sent:</span>
</span><span id="SentMessage-168"><a href="#SentMessage-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_sent</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="SentMessage-169"><a href="#SentMessage-169"><span class="linenos">169</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;is_sent&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span> <span class="n">is_sent</span><span class="p">)</span>
</span><span id="SentMessage-170"><a href="#SentMessage-170"><span class="linenos">170</span></a>
</span><span id="SentMessage-171"><a href="#SentMessage-171"><span class="linenos">171</span></a>        <span class="c1"># Check sent_to:</span>
</span><span id="SentMessage-172"><a href="#SentMessage-172"><span class="linenos">172</span></a>        <span class="n">sent_to_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Contact</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-173"><a href="#SentMessage-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">sent_to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-174"><a href="#SentMessage-174"><span class="linenos">174</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_to</span><span class="p">,</span> <span class="n">Contact</span><span class="p">):</span>
</span><span id="SentMessage-175"><a href="#SentMessage-175"><span class="linenos">175</span></a>                <span class="n">sent_to_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent_to</span><span class="p">]</span>
</span><span id="SentMessage-176"><a href="#SentMessage-176"><span class="linenos">176</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_to</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage-177"><a href="#SentMessage-177"><span class="linenos">177</span></a>                <span class="n">sent_to_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-178"><a href="#SentMessage-178"><span class="linenos">178</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">contact</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sent_to_list</span><span class="p">):</span>
</span><span id="SentMessage-179"><a href="#SentMessage-179"><span class="linenos">179</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="n">Contact</span><span class="p">):</span>
</span><span id="SentMessage-180"><a href="#SentMessage-180"><span class="linenos">180</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-181"><a href="#SentMessage-181"><span class="linenos">181</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sent_to[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Contact&quot;</span><span class="p">,</span> <span class="n">contact</span><span class="p">)</span>
</span><span id="SentMessage-182"><a href="#SentMessage-182"><span class="linenos">182</span></a>                    <span class="n">sent_to_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="SentMessage-183"><a href="#SentMessage-183"><span class="linenos">183</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-184"><a href="#SentMessage-184"><span class="linenos">184</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-185"><a href="#SentMessage-185"><span class="linenos">185</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sent_to&quot;</span><span class="p">,</span> <span class="s2">&quot;Iterable[Contact] | Contact&quot;</span><span class="p">,</span> <span class="n">sent_to</span><span class="p">)</span>
</span><span id="SentMessage-186"><a href="#SentMessage-186"><span class="linenos">186</span></a>
</span><span id="SentMessage-187"><a href="#SentMessage-187"><span class="linenos">187</span></a>        <span class="c1"># Check previews:</span>
</span><span id="SentMessage-188"><a href="#SentMessage-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="n">preview</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preview</span><span class="p">,</span> <span class="n">Preview</span><span class="p">):</span>
</span><span id="SentMessage-189"><a href="#SentMessage-189"><span class="linenos">189</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-190"><a href="#SentMessage-190"><span class="linenos">190</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">,</span> <span class="s2">&quot;Preview&quot;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>
</span><span id="SentMessage-191"><a href="#SentMessage-191"><span class="linenos">191</span></a>
</span><span id="SentMessage-192"><a href="#SentMessage-192"><span class="linenos">192</span></a>        <span class="c1"># Set internal vars:</span>
</span><span id="SentMessage-193"><a href="#SentMessage-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span> <span class="o">=</span> <span class="n">sticker_packs</span>
</span><span id="SentMessage-194"><a href="#SentMessage-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded sticker packs object.&quot;&quot;&quot;</span>
</span><span id="SentMessage-195"><a href="#SentMessage-195"><span class="linenos">195</span></a>
</span><span id="SentMessage-196"><a href="#SentMessage-196"><span class="linenos">196</span></a>        <span class="c1"># Set external properties:</span>
</span><span id="SentMessage-197"><a href="#SentMessage-197"><span class="linenos">197</span></a>        <span class="c1"># Set body:</span>
</span><span id="SentMessage-198"><a href="#SentMessage-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span>
</span><span id="SentMessage-199"><a href="#SentMessage-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The body of the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-200"><a href="#SentMessage-200"><span class="linenos">200</span></a>        <span class="c1"># Set Attachments:</span>
</span><span id="SentMessage-201"><a href="#SentMessage-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]]</span>
</span><span id="SentMessage-202"><a href="#SentMessage-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any attachments to the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-203"><a href="#SentMessage-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attachment_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage-204"><a href="#SentMessage-204"><span class="linenos">204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-205"><a href="#SentMessage-205"><span class="linenos">205</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-206"><a href="#SentMessage-206"><span class="linenos">206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="n">attachment_list</span>
</span><span id="SentMessage-207"><a href="#SentMessage-207"><span class="linenos">207</span></a>        <span class="c1"># Set mentions:</span>
</span><span id="SentMessage-208"><a href="#SentMessage-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="p">:</span> <span class="n">Mentions</span>
</span><span id="SentMessage-209"><a href="#SentMessage-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any mentions in the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-210"><a href="#SentMessage-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mentions</span><span class="p">):</span>
</span><span id="SentMessage-211"><a href="#SentMessage-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">mentions</span>
</span><span id="SentMessage-212"><a href="#SentMessage-212"><span class="linenos">212</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">mentions_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage-213"><a href="#SentMessage-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">)</span>
</span><span id="SentMessage-214"><a href="#SentMessage-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-215"><a href="#SentMessage-215"><span class="linenos">215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">mentions</span><span class="o">=</span><span class="n">mentions_list</span><span class="p">)</span>
</span><span id="SentMessage-216"><a href="#SentMessage-216"><span class="linenos">216</span></a>        <span class="c1"># Set reactions:</span>
</span><span id="SentMessage-217"><a href="#SentMessage-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span> <span class="n">Reactions</span>
</span><span id="SentMessage-218"><a href="#SentMessage-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any reactions to the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-219"><a href="#SentMessage-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reactions</span><span class="p">):</span>
</span><span id="SentMessage-220"><a href="#SentMessage-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">reactions</span>
</span><span id="SentMessage-221"><a href="#SentMessage-221"><span class="linenos">221</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">reaction_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage-222"><a href="#SentMessage-222"><span class="linenos">222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
</span><span id="SentMessage-223"><a href="#SentMessage-223"><span class="linenos">223</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="SentMessage-224"><a href="#SentMessage-224"><span class="linenos">224</span></a>                                       <span class="n">this_device</span><span class="o">=</span><span class="n">this_device</span><span class="p">)</span>
</span><span id="SentMessage-225"><a href="#SentMessage-225"><span class="linenos">225</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-226"><a href="#SentMessage-226"><span class="linenos">226</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
</span><span id="SentMessage-227"><a href="#SentMessage-227"><span class="linenos">227</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="SentMessage-228"><a href="#SentMessage-228"><span class="linenos">228</span></a>                                       <span class="n">this_device</span><span class="o">=</span><span class="n">this_device</span><span class="p">,</span> <span class="n">reactions</span><span class="o">=</span><span class="n">reaction_list</span><span class="p">)</span>
</span><span id="SentMessage-229"><a href="#SentMessage-229"><span class="linenos">229</span></a>        <span class="c1"># Set sticker:</span>
</span><span id="SentMessage-230"><a href="#SentMessage-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="n">sticker</span>
</span><span id="SentMessage-231"><a href="#SentMessage-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The sticker for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-232"><a href="#SentMessage-232"><span class="linenos">232</span></a>        <span class="c1"># Set quote:</span>
</span><span id="SentMessage-233"><a href="#SentMessage-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quote</span><span class="p">]</span> <span class="o">=</span> <span class="n">quote</span>
</span><span id="SentMessage-234"><a href="#SentMessage-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The quote this message contains.&quot;&quot;&quot;</span>
</span><span id="SentMessage-235"><a href="#SentMessage-235"><span class="linenos">235</span></a>        <span class="c1"># Set expiry:</span>
</span><span id="SentMessage-236"><a href="#SentMessage-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="n">expiration</span>
</span><span id="SentMessage-237"><a href="#SentMessage-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The expiration time of this message in seconds as a timedelta.&quot;&quot;&quot;</span>
</span><span id="SentMessage-238"><a href="#SentMessage-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-239"><a href="#SentMessage-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp at which this message expires.&quot;&quot;&quot;</span>
</span><span id="SentMessage-240"><a href="#SentMessage-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="SentMessage-241"><a href="#SentMessage-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is this message expired?&quot;&quot;&quot;</span>
</span><span id="SentMessage-242"><a href="#SentMessage-242"><span class="linenos">242</span></a>        <span class="c1"># Set is sent:</span>
</span><span id="SentMessage-243"><a href="#SentMessage-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_sent</span>
</span><span id="SentMessage-244"><a href="#SentMessage-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Was this message sent?&quot;&quot;&quot;</span>
</span><span id="SentMessage-245"><a href="#SentMessage-245"><span class="linenos">245</span></a>        <span class="c1"># Set sent_to:</span>
</span><span id="SentMessage-246"><a href="#SentMessage-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Contact</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-247"><a href="#SentMessage-247"><span class="linenos">247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of Contacts of who this message has been sent to.&quot;&quot;&quot;</span>
</span><span id="SentMessage-248"><a href="#SentMessage-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="n">sent_to_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-249"><a href="#SentMessage-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="n">sent_to_list</span>
</span><span id="SentMessage-250"><a href="#SentMessage-250"><span class="linenos">250</span></a>        <span class="c1"># Set delivery_receipts, read_receipts and viewed_receipts:</span>
</span><span id="SentMessage-251"><a href="#SentMessage-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-252"><a href="#SentMessage-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The delivery receipts for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-253"><a href="#SentMessage-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-254"><a href="#SentMessage-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The read receipts for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-255"><a href="#SentMessage-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-256"><a href="#SentMessage-256"><span class="linenos">256</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The viewed receipts for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-257"><a href="#SentMessage-257"><span class="linenos">257</span></a>        <span class="c1"># Set previews:</span>
</span><span id="SentMessage-258"><a href="#SentMessage-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="p">:</span> <span class="n">Preview</span> <span class="o">=</span> <span class="n">preview</span>
</span><span id="SentMessage-259"><a href="#SentMessage-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any URL previews for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage-260"><a href="#SentMessage-260"><span class="linenos">260</span></a>
</span><span id="SentMessage-261"><a href="#SentMessage-261"><span class="linenos">261</span></a>        <span class="c1"># Run super init:</span>
</span><span id="SentMessage-262"><a href="#SentMessage-262"><span class="linenos">262</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="p">,</span>
</span><span id="SentMessage-263"><a href="#SentMessage-263"><span class="linenos">263</span></a>                         <span class="n">raw_message</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">get_self</span><span class="p">(),</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">this_device</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">MessageTypes</span><span class="o">.</span><span class="n">SENT</span><span class="p">)</span>
</span><span id="SentMessage-264"><a href="#SentMessage-264"><span class="linenos">264</span></a>
</span><span id="SentMessage-265"><a href="#SentMessage-265"><span class="linenos">265</span></a>        <span class="k">return</span>
</span><span id="SentMessage-266"><a href="#SentMessage-266"><span class="linenos">266</span></a>
</span><span id="SentMessage-267"><a href="#SentMessage-267"><span class="linenos">267</span></a>    <span class="c1">##########################</span>
</span><span id="SentMessage-268"><a href="#SentMessage-268"><span class="linenos">268</span></a>    <span class="c1"># Init:</span>
</span><span id="SentMessage-269"><a href="#SentMessage-269"><span class="linenos">269</span></a>    <span class="c1">##########################</span>
</span><span id="SentMessage-270"><a href="#SentMessage-270"><span class="linenos">270</span></a>    <span class="k">def</span> <span class="nf">__from_raw_message__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_message</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-271"><a href="#SentMessage-271"><span class="linenos">271</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-272"><a href="#SentMessage-272"><span class="linenos">272</span></a><span class="sd">        Load from a dict provided by Signal.</span>
</span><span id="SentMessage-273"><a href="#SentMessage-273"><span class="linenos">273</span></a><span class="sd">        :param raw_message: dict[str, Any]: The dict to load from.</span>
</span><span id="SentMessage-274"><a href="#SentMessage-274"><span class="linenos">274</span></a><span class="sd">        :return: None</span>
</span><span id="SentMessage-275"><a href="#SentMessage-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-276"><a href="#SentMessage-276"><span class="linenos">276</span></a>        <span class="c1"># super().__from_raw_message__(raw_message)</span>
</span><span id="SentMessage-277"><a href="#SentMessage-277"><span class="linenos">277</span></a>        <span class="c1"># Set raw message dict:</span>
</span><span id="SentMessage-278"><a href="#SentMessage-278"><span class="linenos">278</span></a>        <span class="n">raw_sent_message</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_message</span><span class="p">[</span><span class="s1">&#39;sync_message&#39;</span><span class="p">][</span><span class="s1">&#39;sentMessage&#39;</span><span class="p">]</span>
</span><span id="SentMessage-279"><a href="#SentMessage-279"><span class="linenos">279</span></a>
</span><span id="SentMessage-280"><a href="#SentMessage-280"><span class="linenos">280</span></a>        <span class="c1"># Load recipient and recipient type:</span>
</span><span id="SentMessage-281"><a href="#SentMessage-281"><span class="linenos">281</span></a>        <span class="k">if</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;destination&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-282"><a href="#SentMessage-282"><span class="linenos">282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">=</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span>
</span><span id="SentMessage-283"><a href="#SentMessage-283"><span class="linenos">283</span></a>            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;destinationNumber&#39;</span><span class="p">],</span>
</span><span id="SentMessage-284"><a href="#SentMessage-284"><span class="linenos">284</span></a>                                                                  <span class="n">uuid</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;destinationUuid&#39;</span><span class="p">])</span>
</span><span id="SentMessage-285"><a href="#SentMessage-285"><span class="linenos">285</span></a>        <span class="k">elif</span> <span class="s1">&#39;groupInfo&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SentMessage-286"><a href="#SentMessage-286"><span class="linenos">286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">=</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span>
</span><span id="SentMessage-287"><a href="#SentMessage-287"><span class="linenos">287</span></a>            <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">group_id</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;groupInfo&#39;</span><span class="p">][</span><span class="s1">&#39;groupId&#39;</span><span class="p">])</span>
</span><span id="SentMessage-288"><a href="#SentMessage-288"><span class="linenos">288</span></a>
</span><span id="SentMessage-289"><a href="#SentMessage-289"><span class="linenos">289</span></a>        <span class="c1"># Load timestamp:</span>
</span><span id="SentMessage-290"><a href="#SentMessage-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">timestamp</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
</span><span id="SentMessage-291"><a href="#SentMessage-291"><span class="linenos">291</span></a>
</span><span id="SentMessage-292"><a href="#SentMessage-292"><span class="linenos">292</span></a>        <span class="c1"># Load Device:</span>
</span><span id="SentMessage-293"><a href="#SentMessage-293"><span class="linenos">293</span></a>        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">device_id</span><span class="o">=</span><span class="n">raw_message</span><span class="p">[</span><span class="s1">&#39;sourceDevice&#39;</span><span class="p">])</span>
</span><span id="SentMessage-294"><a href="#SentMessage-294"><span class="linenos">294</span></a>
</span><span id="SentMessage-295"><a href="#SentMessage-295"><span class="linenos">295</span></a>        <span class="c1"># Load body:</span>
</span><span id="SentMessage-296"><a href="#SentMessage-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
</span><span id="SentMessage-297"><a href="#SentMessage-297"><span class="linenos">297</span></a>
</span><span id="SentMessage-298"><a href="#SentMessage-298"><span class="linenos">298</span></a>        <span class="c1"># Load attachments:</span>
</span><span id="SentMessage-299"><a href="#SentMessage-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-300"><a href="#SentMessage-300"><span class="linenos">300</span></a>        <span class="k">if</span> <span class="s1">&#39;attachments&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SentMessage-301"><a href="#SentMessage-301"><span class="linenos">301</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-302"><a href="#SentMessage-302"><span class="linenos">302</span></a>            <span class="k">for</span> <span class="n">raw_attachment</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]:</span>
</span><span id="SentMessage-303"><a href="#SentMessage-303"><span class="linenos">303</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Attachment</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">raw_attachment</span><span class="o">=</span><span class="n">raw_attachment</span><span class="p">))</span>
</span><span id="SentMessage-304"><a href="#SentMessage-304"><span class="linenos">304</span></a>
</span><span id="SentMessage-305"><a href="#SentMessage-305"><span class="linenos">305</span></a>        <span class="c1"># Load sticker:</span>
</span><span id="SentMessage-306"><a href="#SentMessage-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-307"><a href="#SentMessage-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="s1">&#39;sticker&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SentMessage-308"><a href="#SentMessage-308"><span class="linenos">308</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span><span class="o">.</span><span class="n">get_sticker</span><span class="p">(</span><span class="n">pack_id</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">][</span><span class="s1">&#39;pack_id&#39;</span><span class="p">],</span>
</span><span id="SentMessage-309"><a href="#SentMessage-309"><span class="linenos">309</span></a>                                                           <span class="n">sticker_id</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">][</span><span class="s1">&#39;sticker_id&#39;</span><span class="p">])</span>
</span><span id="SentMessage-310"><a href="#SentMessage-310"><span class="linenos">310</span></a>
</span><span id="SentMessage-311"><a href="#SentMessage-311"><span class="linenos">311</span></a>        <span class="c1"># Load mentions:</span>
</span><span id="SentMessage-312"><a href="#SentMessage-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-313"><a href="#SentMessage-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="s1">&#39;mentions&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SentMessage-314"><a href="#SentMessage-314"><span class="linenos">314</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">raw_mentions</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">])</span>
</span><span id="SentMessage-315"><a href="#SentMessage-315"><span class="linenos">315</span></a>
</span><span id="SentMessage-316"><a href="#SentMessage-316"><span class="linenos">316</span></a>        <span class="c1"># Load quote:</span>
</span><span id="SentMessage-317"><a href="#SentMessage-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-318"><a href="#SentMessage-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="s1">&#39;quote&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SentMessage-319"><a href="#SentMessage-319"><span class="linenos">319</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="SentMessage-320"><a href="#SentMessage-320"><span class="linenos">320</span></a>                               <span class="n">raw_quote</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">])</span>
</span><span id="SentMessage-321"><a href="#SentMessage-321"><span class="linenos">321</span></a>
</span><span id="SentMessage-322"><a href="#SentMessage-322"><span class="linenos">322</span></a>        <span class="c1"># Load expiry:</span>
</span><span id="SentMessage-323"><a href="#SentMessage-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;expiresInSeconds&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage-324"><a href="#SentMessage-324"><span class="linenos">324</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-325"><a href="#SentMessage-325"><span class="linenos">325</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-326"><a href="#SentMessage-326"><span class="linenos">326</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="SentMessage-327"><a href="#SentMessage-327"><span class="linenos">327</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-328"><a href="#SentMessage-328"><span class="linenos">328</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;expiresInSeconds&#39;</span><span class="p">])</span>
</span><span id="SentMessage-329"><a href="#SentMessage-329"><span class="linenos">329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-330"><a href="#SentMessage-330"><span class="linenos">330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="SentMessage-331"><a href="#SentMessage-331"><span class="linenos">331</span></a>
</span><span id="SentMessage-332"><a href="#SentMessage-332"><span class="linenos">332</span></a>        <span class="c1"># Load preview:</span>
</span><span id="SentMessage-333"><a href="#SentMessage-333"><span class="linenos">333</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preview</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-334"><a href="#SentMessage-334"><span class="linenos">334</span></a>        <span class="k">if</span> <span class="s1">&#39;preview&#39;</span> <span class="ow">in</span> <span class="n">raw_sent_message</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="SentMessage-335"><a href="#SentMessage-335"><span class="linenos">335</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">preview</span> <span class="o">=</span> <span class="n">Preview</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">raw_preview</span><span class="o">=</span><span class="n">raw_sent_message</span><span class="p">[</span><span class="s1">&#39;preview&#39;</span><span class="p">])</span>
</span><span id="SentMessage-336"><a href="#SentMessage-336"><span class="linenos">336</span></a>
</span><span id="SentMessage-337"><a href="#SentMessage-337"><span class="linenos">337</span></a>        <span class="c1"># Set sent, since this is coming from a sync message.</span>
</span><span id="SentMessage-338"><a href="#SentMessage-338"><span class="linenos">338</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="SentMessage-339"><a href="#SentMessage-339"><span class="linenos">339</span></a>
</span><span id="SentMessage-340"><a href="#SentMessage-340"><span class="linenos">340</span></a>        <span class="c1"># Set sent to, if a group, assume sent to all current members.</span>
</span><span id="SentMessage-341"><a href="#SentMessage-341"><span class="linenos">341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-342"><a href="#SentMessage-342"><span class="linenos">342</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span><span class="p">:</span>
</span><span id="SentMessage-343"><a href="#SentMessage-343"><span class="linenos">343</span></a>            <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
</span><span id="SentMessage-344"><a href="#SentMessage-344"><span class="linenos">344</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="SentMessage-345"><a href="#SentMessage-345"><span class="linenos">345</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span><span class="p">:</span>
</span><span id="SentMessage-346"><a href="#SentMessage-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">]</span>
</span><span id="SentMessage-347"><a href="#SentMessage-347"><span class="linenos">347</span></a>        <span class="k">return</span>
</span><span id="SentMessage-348"><a href="#SentMessage-348"><span class="linenos">348</span></a>
</span><span id="SentMessage-349"><a href="#SentMessage-349"><span class="linenos">349</span></a>    <span class="c1">###########################</span>
</span><span id="SentMessage-350"><a href="#SentMessage-350"><span class="linenos">350</span></a>    <span class="c1"># To / From Dict:</span>
</span><span id="SentMessage-351"><a href="#SentMessage-351"><span class="linenos">351</span></a>    <span class="c1">###########################</span>
</span><span id="SentMessage-352"><a href="#SentMessage-352"><span class="linenos">352</span></a>    <span class="k">def</span> <span class="nf">__to_dict__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="SentMessage-353"><a href="#SentMessage-353"><span class="linenos">353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-354"><a href="#SentMessage-354"><span class="linenos">354</span></a><span class="sd">        Create a JSON friendly dict to store this sent message in.</span>
</span><span id="SentMessage-355"><a href="#SentMessage-355"><span class="linenos">355</span></a><span class="sd">        :return: dict[str, Any]: A dict to provide to __from_dict__().</span>
</span><span id="SentMessage-356"><a href="#SentMessage-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-357"><a href="#SentMessage-357"><span class="linenos">357</span></a>        <span class="c1"># Call super:</span>
</span><span id="SentMessage-358"><a href="#SentMessage-358"><span class="linenos">358</span></a>        <span class="n">sent_message_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="SentMessage-359"><a href="#SentMessage-359"><span class="linenos">359</span></a>
</span><span id="SentMessage-360"><a href="#SentMessage-360"><span class="linenos">360</span></a>        <span class="c1"># Set body:</span>
</span><span id="SentMessage-361"><a href="#SentMessage-361"><span class="linenos">361</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span>
</span><span id="SentMessage-362"><a href="#SentMessage-362"><span class="linenos">362</span></a>
</span><span id="SentMessage-363"><a href="#SentMessage-363"><span class="linenos">363</span></a>        <span class="c1"># Set attachments:</span>
</span><span id="SentMessage-364"><a href="#SentMessage-364"><span class="linenos">364</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-365"><a href="#SentMessage-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-366"><a href="#SentMessage-366"><span class="linenos">366</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s2">&quot;attachments&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-367"><a href="#SentMessage-367"><span class="linenos">367</span></a>            <span class="k">for</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="p">:</span>
</span><span id="SentMessage-368"><a href="#SentMessage-368"><span class="linenos">368</span></a>                <span class="n">sent_message_dict</span><span class="p">[</span><span class="s2">&quot;attachments&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="SentMessage-369"><a href="#SentMessage-369"><span class="linenos">369</span></a>
</span><span id="SentMessage-370"><a href="#SentMessage-370"><span class="linenos">370</span></a>        <span class="c1"># Set Mentions:</span>
</span><span id="SentMessage-371"><a href="#SentMessage-371"><span class="linenos">371</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-372"><a href="#SentMessage-372"><span class="linenos">372</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-373"><a href="#SentMessage-373"><span class="linenos">373</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="SentMessage-374"><a href="#SentMessage-374"><span class="linenos">374</span></a>
</span><span id="SentMessage-375"><a href="#SentMessage-375"><span class="linenos">375</span></a>        <span class="c1"># Set Reactions:</span>
</span><span id="SentMessage-376"><a href="#SentMessage-376"><span class="linenos">376</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-377"><a href="#SentMessage-377"><span class="linenos">377</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-378"><a href="#SentMessage-378"><span class="linenos">378</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="SentMessage-379"><a href="#SentMessage-379"><span class="linenos">379</span></a>
</span><span id="SentMessage-380"><a href="#SentMessage-380"><span class="linenos">380</span></a>        <span class="c1"># Set sticker:</span>
</span><span id="SentMessage-381"><a href="#SentMessage-381"><span class="linenos">381</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-382"><a href="#SentMessage-382"><span class="linenos">382</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-383"><a href="#SentMessage-383"><span class="linenos">383</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="SentMessage-384"><a href="#SentMessage-384"><span class="linenos">384</span></a>                <span class="s1">&#39;packId&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="o">.</span><span class="n">pack_id</span><span class="p">,</span>  <span class="c1"># String</span>
</span><span id="SentMessage-385"><a href="#SentMessage-385"><span class="linenos">385</span></a>                <span class="s1">&#39;stickerId&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="o">.</span><span class="n">id</span>  <span class="c1"># Integer</span>
</span><span id="SentMessage-386"><a href="#SentMessage-386"><span class="linenos">386</span></a>            <span class="p">}</span>
</span><span id="SentMessage-387"><a href="#SentMessage-387"><span class="linenos">387</span></a>
</span><span id="SentMessage-388"><a href="#SentMessage-388"><span class="linenos">388</span></a>        <span class="c1"># Set quote:</span>
</span><span id="SentMessage-389"><a href="#SentMessage-389"><span class="linenos">389</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-390"><a href="#SentMessage-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-391"><a href="#SentMessage-391"><span class="linenos">391</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quote</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="SentMessage-392"><a href="#SentMessage-392"><span class="linenos">392</span></a>
</span><span id="SentMessage-393"><a href="#SentMessage-393"><span class="linenos">393</span></a>        <span class="c1"># Set expiration:</span>
</span><span id="SentMessage-394"><a href="#SentMessage-394"><span class="linenos">394</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-395"><a href="#SentMessage-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-396"><a href="#SentMessage-396"><span class="linenos">396</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span><span class="o">.</span><span class="n">seconds</span>
</span><span id="SentMessage-397"><a href="#SentMessage-397"><span class="linenos">397</span></a>
</span><span id="SentMessage-398"><a href="#SentMessage-398"><span class="linenos">398</span></a>        <span class="c1"># Set expiration timestamp:</span>
</span><span id="SentMessage-399"><a href="#SentMessage-399"><span class="linenos">399</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-400"><a href="#SentMessage-400"><span class="linenos">400</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-401"><a href="#SentMessage-401"><span class="linenos">401</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">()</span>
</span><span id="SentMessage-402"><a href="#SentMessage-402"><span class="linenos">402</span></a>
</span><span id="SentMessage-403"><a href="#SentMessage-403"><span class="linenos">403</span></a>        <span class="c1"># Set is expired:</span>
</span><span id="SentMessage-404"><a href="#SentMessage-404"><span class="linenos">404</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;isExpired&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span>
</span><span id="SentMessage-405"><a href="#SentMessage-405"><span class="linenos">405</span></a>
</span><span id="SentMessage-406"><a href="#SentMessage-406"><span class="linenos">406</span></a>        <span class="c1"># Set is sent:</span>
</span><span id="SentMessage-407"><a href="#SentMessage-407"><span class="linenos">407</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;isSent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span>
</span><span id="SentMessage-408"><a href="#SentMessage-408"><span class="linenos">408</span></a>
</span><span id="SentMessage-409"><a href="#SentMessage-409"><span class="linenos">409</span></a>        <span class="c1"># Set sent_to list:</span>
</span><span id="SentMessage-410"><a href="#SentMessage-410"><span class="linenos">410</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-411"><a href="#SentMessage-411"><span class="linenos">411</span></a>        <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="p">:</span>
</span><span id="SentMessage-412"><a href="#SentMessage-412"><span class="linenos">412</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
</span><span id="SentMessage-413"><a href="#SentMessage-413"><span class="linenos">413</span></a>
</span><span id="SentMessage-414"><a href="#SentMessage-414"><span class="linenos">414</span></a>        <span class="c1"># Set delivery_receipts list:</span>
</span><span id="SentMessage-415"><a href="#SentMessage-415"><span class="linenos">415</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;deliveryReceipts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-416"><a href="#SentMessage-416"><span class="linenos">416</span></a>        <span class="k">for</span> <span class="n">receipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="p">:</span>
</span><span id="SentMessage-417"><a href="#SentMessage-417"><span class="linenos">417</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;deliveryReceipts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="SentMessage-418"><a href="#SentMessage-418"><span class="linenos">418</span></a>
</span><span id="SentMessage-419"><a href="#SentMessage-419"><span class="linenos">419</span></a>        <span class="c1"># Set read_receipts list:</span>
</span><span id="SentMessage-420"><a href="#SentMessage-420"><span class="linenos">420</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;readReceipts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-421"><a href="#SentMessage-421"><span class="linenos">421</span></a>        <span class="k">for</span> <span class="n">receipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="p">:</span>
</span><span id="SentMessage-422"><a href="#SentMessage-422"><span class="linenos">422</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;readReceipts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="SentMessage-423"><a href="#SentMessage-423"><span class="linenos">423</span></a>
</span><span id="SentMessage-424"><a href="#SentMessage-424"><span class="linenos">424</span></a>        <span class="c1"># Set viewed_receipts list:</span>
</span><span id="SentMessage-425"><a href="#SentMessage-425"><span class="linenos">425</span></a>        <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;viewedReceipts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-426"><a href="#SentMessage-426"><span class="linenos">426</span></a>        <span class="k">for</span> <span class="n">receipt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="p">:</span>
</span><span id="SentMessage-427"><a href="#SentMessage-427"><span class="linenos">427</span></a>            <span class="n">sent_message_dict</span><span class="p">[</span><span class="s1">&#39;viewedReceipts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">__to_dict__</span><span class="p">())</span>
</span><span id="SentMessage-428"><a href="#SentMessage-428"><span class="linenos">428</span></a>        <span class="c1"># Return Resulting dict:</span>
</span><span id="SentMessage-429"><a href="#SentMessage-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="n">sent_message_dict</span>
</span><span id="SentMessage-430"><a href="#SentMessage-430"><span class="linenos">430</span></a>
</span><span id="SentMessage-431"><a href="#SentMessage-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">__from_dict__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-432"><a href="#SentMessage-432"><span class="linenos">432</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__from_dict__</span><span class="p">(</span><span class="n">from_dict</span><span class="p">)</span>
</span><span id="SentMessage-433"><a href="#SentMessage-433"><span class="linenos">433</span></a>        <span class="c1"># Load Body:</span>
</span><span id="SentMessage-434"><a href="#SentMessage-434"><span class="linenos">434</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span>
</span><span id="SentMessage-435"><a href="#SentMessage-435"><span class="linenos">435</span></a>
</span><span id="SentMessage-436"><a href="#SentMessage-436"><span class="linenos">436</span></a>        <span class="c1"># Load attachments:</span>
</span><span id="SentMessage-437"><a href="#SentMessage-437"><span class="linenos">437</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-438"><a href="#SentMessage-438"><span class="linenos">438</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-439"><a href="#SentMessage-439"><span class="linenos">439</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-440"><a href="#SentMessage-440"><span class="linenos">440</span></a>            <span class="k">for</span> <span class="n">attachmentDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;attachments&#39;</span><span class="p">]:</span>
</span><span id="SentMessage-441"><a href="#SentMessage-441"><span class="linenos">441</span></a>                <span class="n">attachment</span> <span class="o">=</span> <span class="n">Attachment</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">attachmentDict</span><span class="p">)</span>
</span><span id="SentMessage-442"><a href="#SentMessage-442"><span class="linenos">442</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
</span><span id="SentMessage-443"><a href="#SentMessage-443"><span class="linenos">443</span></a>
</span><span id="SentMessage-444"><a href="#SentMessage-444"><span class="linenos">444</span></a>        <span class="c1"># Load mentions:</span>
</span><span id="SentMessage-445"><a href="#SentMessage-445"><span class="linenos">445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-446"><a href="#SentMessage-446"><span class="linenos">446</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-447"><a href="#SentMessage-447"><span class="linenos">447</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;mentions&#39;</span><span class="p">])</span>
</span><span id="SentMessage-448"><a href="#SentMessage-448"><span class="linenos">448</span></a>
</span><span id="SentMessage-449"><a href="#SentMessage-449"><span class="linenos">449</span></a>        <span class="c1"># Load reactions:</span>
</span><span id="SentMessage-450"><a href="#SentMessage-450"><span class="linenos">450</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-451"><a href="#SentMessage-451"><span class="linenos">451</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-452"><a href="#SentMessage-452"><span class="linenos">452</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage-453"><a href="#SentMessage-453"><span class="linenos">453</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="SentMessage-454"><a href="#SentMessage-454"><span class="linenos">454</span></a>                                       <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span> <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span>
</span><span id="SentMessage-455"><a href="#SentMessage-455"><span class="linenos">455</span></a>                                       <span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;reactions&#39;</span><span class="p">])</span>
</span><span id="SentMessage-456"><a href="#SentMessage-456"><span class="linenos">456</span></a>
</span><span id="SentMessage-457"><a href="#SentMessage-457"><span class="linenos">457</span></a>        <span class="c1"># Load sticker</span>
</span><span id="SentMessage-458"><a href="#SentMessage-458"><span class="linenos">458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-459"><a href="#SentMessage-459"><span class="linenos">459</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-460"><a href="#SentMessage-460"><span class="linenos">460</span></a>            <span class="n">sticker_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sticker&#39;</span><span class="p">]</span>
</span><span id="SentMessage-461"><a href="#SentMessage-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span><span class="o">.</span><span class="n">get_sticker</span><span class="p">(</span>
</span><span id="SentMessage-462"><a href="#SentMessage-462"><span class="linenos">462</span></a>                <span class="n">pack_id</span><span class="o">=</span><span class="n">sticker_dict</span><span class="p">[</span><span class="s1">&#39;packId&#39;</span><span class="p">],</span>  <span class="c1"># String</span>
</span><span id="SentMessage-463"><a href="#SentMessage-463"><span class="linenos">463</span></a>                <span class="n">sticker_id</span><span class="o">=</span><span class="n">sticker_dict</span><span class="p">[</span><span class="s1">&#39;stickerId&#39;</span><span class="p">]</span>  <span class="c1"># Integer</span>
</span><span id="SentMessage-464"><a href="#SentMessage-464"><span class="linenos">464</span></a>            <span class="p">)</span>
</span><span id="SentMessage-465"><a href="#SentMessage-465"><span class="linenos">465</span></a>
</span><span id="SentMessage-466"><a href="#SentMessage-466"><span class="linenos">466</span></a>        <span class="c1"># Load Quote:</span>
</span><span id="SentMessage-467"><a href="#SentMessage-467"><span class="linenos">467</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-468"><a href="#SentMessage-468"><span class="linenos">468</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-469"><a href="#SentMessage-469"><span class="linenos">469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">])</span>
</span><span id="SentMessage-470"><a href="#SentMessage-470"><span class="linenos">470</span></a>
</span><span id="SentMessage-471"><a href="#SentMessage-471"><span class="linenos">471</span></a>        <span class="c1"># Load expiration:</span>
</span><span id="SentMessage-472"><a href="#SentMessage-472"><span class="linenos">472</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-473"><a href="#SentMessage-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-474"><a href="#SentMessage-474"><span class="linenos">474</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expiration&#39;</span><span class="p">])</span>
</span><span id="SentMessage-475"><a href="#SentMessage-475"><span class="linenos">475</span></a>
</span><span id="SentMessage-476"><a href="#SentMessage-476"><span class="linenos">476</span></a>        <span class="c1"># Load expiration timestamp:</span>
</span><span id="SentMessage-477"><a href="#SentMessage-477"><span class="linenos">477</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-478"><a href="#SentMessage-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-479"><a href="#SentMessage-479"><span class="linenos">479</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">from_dict</span><span class="o">=</span><span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;expirationTimestamp&#39;</span><span class="p">])</span>
</span><span id="SentMessage-480"><a href="#SentMessage-480"><span class="linenos">480</span></a>
</span><span id="SentMessage-481"><a href="#SentMessage-481"><span class="linenos">481</span></a>        <span class="c1"># Load is expired:</span>
</span><span id="SentMessage-482"><a href="#SentMessage-482"><span class="linenos">482</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;isExpired&#39;</span><span class="p">]</span>
</span><span id="SentMessage-483"><a href="#SentMessage-483"><span class="linenos">483</span></a>
</span><span id="SentMessage-484"><a href="#SentMessage-484"><span class="linenos">484</span></a>        <span class="c1"># Load is_sent:</span>
</span><span id="SentMessage-485"><a href="#SentMessage-485"><span class="linenos">485</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span> <span class="o">=</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;isSent&#39;</span><span class="p">]</span>
</span><span id="SentMessage-486"><a href="#SentMessage-486"><span class="linenos">486</span></a>
</span><span id="SentMessage-487"><a href="#SentMessage-487"><span class="linenos">487</span></a>        <span class="c1"># Load sent_to:</span>
</span><span id="SentMessage-488"><a href="#SentMessage-488"><span class="linenos">488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-489"><a href="#SentMessage-489"><span class="linenos">489</span></a>        <span class="k">if</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-490"><a href="#SentMessage-490"><span class="linenos">490</span></a>            <span class="k">for</span> <span class="n">contact_id</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;sentTo&#39;</span><span class="p">]:</span>
</span><span id="SentMessage-491"><a href="#SentMessage-491"><span class="linenos">491</span></a>                <span class="n">_</span><span class="p">,</span> <span class="n">contact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="o">.</span><span class="n">__get_or_add__</span><span class="p">(</span><span class="n">contact_id</span><span class="o">=</span><span class="n">contact_id</span><span class="p">)</span>
</span><span id="SentMessage-492"><a href="#SentMessage-492"><span class="linenos">492</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="SentMessage-493"><a href="#SentMessage-493"><span class="linenos">493</span></a>
</span><span id="SentMessage-494"><a href="#SentMessage-494"><span class="linenos">494</span></a>        <span class="c1"># Load delivery_receipts:</span>
</span><span id="SentMessage-495"><a href="#SentMessage-495"><span class="linenos">495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-496"><a href="#SentMessage-496"><span class="linenos">496</span></a>        <span class="k">for</span> <span class="n">receiptDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;deliveryReceipts&#39;</span><span class="p">]:</span>
</span><span id="SentMessage-497"><a href="#SentMessage-497"><span class="linenos">497</span></a>            <span class="n">receipt</span> <span class="o">=</span> <span class="n">Receipt</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage-498"><a href="#SentMessage-498"><span class="linenos">498</span></a>                              <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage-499"><a href="#SentMessage-499"><span class="linenos">499</span></a>                              <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage-500"><a href="#SentMessage-500"><span class="linenos">500</span></a>                              <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">receiptDict</span><span class="p">)</span>
</span><span id="SentMessage-501"><a href="#SentMessage-501"><span class="linenos">501</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="SentMessage-502"><a href="#SentMessage-502"><span class="linenos">502</span></a>
</span><span id="SentMessage-503"><a href="#SentMessage-503"><span class="linenos">503</span></a>        <span class="c1"># Load read_receipts:</span>
</span><span id="SentMessage-504"><a href="#SentMessage-504"><span class="linenos">504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-505"><a href="#SentMessage-505"><span class="linenos">505</span></a>        <span class="k">for</span> <span class="n">receiptDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;readReceipts&#39;</span><span class="p">]:</span>
</span><span id="SentMessage-506"><a href="#SentMessage-506"><span class="linenos">506</span></a>            <span class="n">receipt</span> <span class="o">=</span> <span class="n">Receipt</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage-507"><a href="#SentMessage-507"><span class="linenos">507</span></a>                              <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage-508"><a href="#SentMessage-508"><span class="linenos">508</span></a>                              <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage-509"><a href="#SentMessage-509"><span class="linenos">509</span></a>                              <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">receiptDict</span><span class="p">)</span>
</span><span id="SentMessage-510"><a href="#SentMessage-510"><span class="linenos">510</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="SentMessage-511"><a href="#SentMessage-511"><span class="linenos">511</span></a>
</span><span id="SentMessage-512"><a href="#SentMessage-512"><span class="linenos">512</span></a>        <span class="c1"># Load viewed_receipts:</span>
</span><span id="SentMessage-513"><a href="#SentMessage-513"><span class="linenos">513</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage-514"><a href="#SentMessage-514"><span class="linenos">514</span></a>        <span class="k">for</span> <span class="n">receiptDict</span> <span class="ow">in</span> <span class="n">from_dict</span><span class="p">[</span><span class="s1">&#39;viewedReceipts&#39;</span><span class="p">]:</span>
</span><span id="SentMessage-515"><a href="#SentMessage-515"><span class="linenos">515</span></a>            <span class="n">receipt</span> <span class="o">=</span> <span class="n">Receipt</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage-516"><a href="#SentMessage-516"><span class="linenos">516</span></a>                              <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage-517"><a href="#SentMessage-517"><span class="linenos">517</span></a>                              <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage-518"><a href="#SentMessage-518"><span class="linenos">518</span></a>                              <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="o">=</span><span class="n">receiptDict</span><span class="p">)</span>
</span><span id="SentMessage-519"><a href="#SentMessage-519"><span class="linenos">519</span></a>        <span class="k">return</span>
</span><span id="SentMessage-520"><a href="#SentMessage-520"><span class="linenos">520</span></a>
</span><span id="SentMessage-521"><a href="#SentMessage-521"><span class="linenos">521</span></a>    <span class="c1">###########################</span>
</span><span id="SentMessage-522"><a href="#SentMessage-522"><span class="linenos">522</span></a>    <span class="c1"># Helpers:</span>
</span><span id="SentMessage-523"><a href="#SentMessage-523"><span class="linenos">523</span></a>    <span class="c1">###########################</span>
</span><span id="SentMessage-524"><a href="#SentMessage-524"><span class="linenos">524</span></a>    <span class="k">def</span> <span class="nf">__parse_receipt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receipt</span><span class="p">:</span> <span class="n">Receipt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-525"><a href="#SentMessage-525"><span class="linenos">525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-526"><a href="#SentMessage-526"><span class="linenos">526</span></a><span class="sd">        Parse a receipt message, storing it in the right list, and acting on it.</span>
</span><span id="SentMessage-527"><a href="#SentMessage-527"><span class="linenos">527</span></a><span class="sd">        :param receipt: Receipt: The receipt to parse.</span>
</span><span id="SentMessage-528"><a href="#SentMessage-528"><span class="linenos">528</span></a><span class="sd">        :return:</span>
</span><span id="SentMessage-529"><a href="#SentMessage-529"><span class="linenos">529</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-530"><a href="#SentMessage-530"><span class="linenos">530</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="SentMessage-531"><a href="#SentMessage-531"><span class="linenos">531</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parse_receipt__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="SentMessage-532"><a href="#SentMessage-532"><span class="linenos">532</span></a>        <span class="c1"># Parse the receipt based on type:</span>
</span><span id="SentMessage-533"><a href="#SentMessage-533"><span class="linenos">533</span></a>        <span class="k">if</span> <span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span> <span class="o">==</span> <span class="n">ReceiptTypes</span><span class="o">.</span><span class="n">DELIVER</span><span class="p">:</span>
</span><span id="SentMessage-534"><a href="#SentMessage-534"><span class="linenos">534</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mark_delivered</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">when</span><span class="p">)</span>
</span><span id="SentMessage-535"><a href="#SentMessage-535"><span class="linenos">535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="SentMessage-536"><a href="#SentMessage-536"><span class="linenos">536</span></a>        <span class="k">elif</span> <span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span> <span class="o">==</span> <span class="n">ReceiptTypes</span><span class="o">.</span><span class="n">READ</span><span class="p">:</span>
</span><span id="SentMessage-537"><a href="#SentMessage-537"><span class="linenos">537</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mark_read</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">when</span><span class="p">)</span>
</span><span id="SentMessage-538"><a href="#SentMessage-538"><span class="linenos">538</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="SentMessage-539"><a href="#SentMessage-539"><span class="linenos">539</span></a>        <span class="k">elif</span> <span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span> <span class="o">==</span> <span class="n">ReceiptTypes</span><span class="o">.</span><span class="n">VIEWED</span><span class="p">:</span>
</span><span id="SentMessage-540"><a href="#SentMessage-540"><span class="linenos">540</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mark_viewed</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">when</span><span class="p">)</span>
</span><span id="SentMessage-541"><a href="#SentMessage-541"><span class="linenos">541</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">receipt</span><span class="p">)</span>
</span><span id="SentMessage-542"><a href="#SentMessage-542"><span class="linenos">542</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-543"><a href="#SentMessage-543"><span class="linenos">543</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;invalid receipt type, cannot parse: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">receipt</span><span class="o">.</span><span class="n">receipt_type</span><span class="p">)</span>
</span><span id="SentMessage-544"><a href="#SentMessage-544"><span class="linenos">544</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising RuntimeError(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage-545"><a href="#SentMessage-545"><span class="linenos">545</span></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage-546"><a href="#SentMessage-546"><span class="linenos">546</span></a>        <span class="k">return</span>
</span><span id="SentMessage-547"><a href="#SentMessage-547"><span class="linenos">547</span></a>
</span><span id="SentMessage-548"><a href="#SentMessage-548"><span class="linenos">548</span></a>    <span class="k">def</span> <span class="nf">__set_expiry__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_opened</span><span class="p">:</span> <span class="n">Timestamp</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-549"><a href="#SentMessage-549"><span class="linenos">549</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-550"><a href="#SentMessage-550"><span class="linenos">550</span></a><span class="sd">        Set the expiration datetime object.</span>
</span><span id="SentMessage-551"><a href="#SentMessage-551"><span class="linenos">551</span></a><span class="sd">        :param time_opened: Timestamp: The time the message was opened.</span>
</span><span id="SentMessage-552"><a href="#SentMessage-552"><span class="linenos">552</span></a><span class="sd">        :return: None</span>
</span><span id="SentMessage-553"><a href="#SentMessage-553"><span class="linenos">553</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-554"><a href="#SentMessage-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-555"><a href="#SentMessage-555"><span class="linenos">555</span></a>            <span class="n">expiry_datetime</span> <span class="o">=</span> <span class="n">time_opened</span><span class="o">.</span><span class="n">datetime</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span>
</span><span id="SentMessage-556"><a href="#SentMessage-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="n">datetime_obj</span><span class="o">=</span><span class="n">expiry_datetime</span><span class="p">)</span>
</span><span id="SentMessage-557"><a href="#SentMessage-557"><span class="linenos">557</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-558"><a href="#SentMessage-558"><span class="linenos">558</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage-559"><a href="#SentMessage-559"><span class="linenos">559</span></a>        <span class="k">return</span>
</span><span id="SentMessage-560"><a href="#SentMessage-560"><span class="linenos">560</span></a>
</span><span id="SentMessage-561"><a href="#SentMessage-561"><span class="linenos">561</span></a>    <span class="c1">###########################</span>
</span><span id="SentMessage-562"><a href="#SentMessage-562"><span class="linenos">562</span></a>    <span class="c1"># Methods:</span>
</span><span id="SentMessage-563"><a href="#SentMessage-563"><span class="linenos">563</span></a>    <span class="c1">###########################</span>
</span><span id="SentMessage-564"><a href="#SentMessage-564"><span class="linenos">564</span></a>    <span class="c1"># def mark_delivered(self, when: Optional[Timestamp] = None) -&gt; None:</span>
</span><span id="SentMessage-565"><a href="#SentMessage-565"><span class="linenos">565</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="SentMessage-566"><a href="#SentMessage-566"><span class="linenos">566</span></a>    <span class="c1">#     Mark this message as delivered.</span>
</span><span id="SentMessage-567"><a href="#SentMessage-567"><span class="linenos">567</span></a>    <span class="c1">#     :param when: Optional[Timestamp]: The timestamp for when this was delivered; If None, NOW is used.</span>
</span><span id="SentMessage-568"><a href="#SentMessage-568"><span class="linenos">568</span></a>    <span class="c1">#     :return: None</span>
</span><span id="SentMessage-569"><a href="#SentMessage-569"><span class="linenos">569</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="SentMessage-570"><a href="#SentMessage-570"><span class="linenos">570</span></a>    <span class="c1">#     return super().mark_delivered(when)</span>
</span><span id="SentMessage-571"><a href="#SentMessage-571"><span class="linenos">571</span></a>    <span class="c1">#</span>
</span><span id="SentMessage-572"><a href="#SentMessage-572"><span class="linenos">572</span></a>    <span class="c1"># def mark_read(self, when: Optional[Timestamp] = None) -&gt; None:</span>
</span><span id="SentMessage-573"><a href="#SentMessage-573"><span class="linenos">573</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="SentMessage-574"><a href="#SentMessage-574"><span class="linenos">574</span></a>    <span class="c1">#     Mark this message as read.</span>
</span><span id="SentMessage-575"><a href="#SentMessage-575"><span class="linenos">575</span></a>    <span class="c1">#     :param when: Optional[Timestamp]: The timestamp for when this was read; If None, NOW is used.</span>
</span><span id="SentMessage-576"><a href="#SentMessage-576"><span class="linenos">576</span></a>    <span class="c1">#     :return: None</span>
</span><span id="SentMessage-577"><a href="#SentMessage-577"><span class="linenos">577</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="SentMessage-578"><a href="#SentMessage-578"><span class="linenos">578</span></a>    <span class="c1">#     return super().mark_read(when)</span>
</span><span id="SentMessage-579"><a href="#SentMessage-579"><span class="linenos">579</span></a>    <span class="c1">#</span>
</span><span id="SentMessage-580"><a href="#SentMessage-580"><span class="linenos">580</span></a>    <span class="c1"># def mark_viewed(self, when: Optional[Timestamp] = None) -&gt; None:</span>
</span><span id="SentMessage-581"><a href="#SentMessage-581"><span class="linenos">581</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="SentMessage-582"><a href="#SentMessage-582"><span class="linenos">582</span></a>    <span class="c1">#     Mark this message as viewed.</span>
</span><span id="SentMessage-583"><a href="#SentMessage-583"><span class="linenos">583</span></a>    <span class="c1">#     :param when: Optional[Timestamp]: The timestamp for when this was viewed; If None, NOW is used.</span>
</span><span id="SentMessage-584"><a href="#SentMessage-584"><span class="linenos">584</span></a>    <span class="c1">#     :return: None</span>
</span><span id="SentMessage-585"><a href="#SentMessage-585"><span class="linenos">585</span></a>    <span class="c1">#     &quot;&quot;&quot;</span>
</span><span id="SentMessage-586"><a href="#SentMessage-586"><span class="linenos">586</span></a>    <span class="c1">#     return super().mark_viewed(when)</span>
</span><span id="SentMessage-587"><a href="#SentMessage-587"><span class="linenos">587</span></a>
</span><span id="SentMessage-588"><a href="#SentMessage-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">get_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Quote</span><span class="p">:</span>
</span><span id="SentMessage-589"><a href="#SentMessage-589"><span class="linenos">589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-590"><a href="#SentMessage-590"><span class="linenos">590</span></a><span class="sd">        Get a quote object for this message.</span>
</span><span id="SentMessage-591"><a href="#SentMessage-591"><span class="linenos">591</span></a><span class="sd">        :return: Quote: This message as a Quote object.</span>
</span><span id="SentMessage-592"><a href="#SentMessage-592"><span class="linenos">592</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-593"><a href="#SentMessage-593"><span class="linenos">593</span></a>        <span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="SentMessage-594"><a href="#SentMessage-594"><span class="linenos">594</span></a>                      <span class="n">timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">mentions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="p">,</span>
</span><span id="SentMessage-595"><a href="#SentMessage-595"><span class="linenos">595</span></a>                      <span class="n">conversation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">)</span>
</span><span id="SentMessage-596"><a href="#SentMessage-596"><span class="linenos">596</span></a>        <span class="k">return</span> <span class="n">quote</span>
</span><span id="SentMessage-597"><a href="#SentMessage-597"><span class="linenos">597</span></a>
</span><span id="SentMessage-598"><a href="#SentMessage-598"><span class="linenos">598</span></a>    <span class="k">def</span> <span class="nf">parse_mentions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="SentMessage-599"><a href="#SentMessage-599"><span class="linenos">599</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-600"><a href="#SentMessage-600"><span class="linenos">600</span></a><span class="sd">        Parse mentions in this message.</span>
</span><span id="SentMessage-601"><a href="#SentMessage-601"><span class="linenos">601</span></a><span class="sd">        :return: str: The body with mentions parsed; If &#39;mentions&#39; is None, the original body is returned.</span>
</span><span id="SentMessage-602"><a href="#SentMessage-602"><span class="linenos">602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-603"><a href="#SentMessage-603"><span class="linenos">603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage-604"><a href="#SentMessage-604"><span class="linenos">604</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span>
</span><span id="SentMessage-605"><a href="#SentMessage-605"><span class="linenos">605</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="o">.</span><span class="n">__parse_mentions__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span><span id="SentMessage-606"><a href="#SentMessage-606"><span class="linenos">606</span></a>
</span><span id="SentMessage-607"><a href="#SentMessage-607"><span class="linenos">607</span></a>    <span class="k">def</span> <span class="nf">react</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emoji</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Reaction</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="SentMessage-608"><a href="#SentMessage-608"><span class="linenos">608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-609"><a href="#SentMessage-609"><span class="linenos">609</span></a><span class="sd">        Send a reaction to this message.</span>
</span><span id="SentMessage-610"><a href="#SentMessage-610"><span class="linenos">610</span></a><span class="sd">        :param emoji: str: The emoji to react with.</span>
</span><span id="SentMessage-611"><a href="#SentMessage-611"><span class="linenos">611</span></a><span class="sd">        :return: tuple[bool, Reaction | str]: The first element is a bool which is either True or False on success or</span>
</span><span id="SentMessage-612"><a href="#SentMessage-612"><span class="linenos">612</span></a><span class="sd">            failure.</span>
</span><span id="SentMessage-613"><a href="#SentMessage-613"><span class="linenos">613</span></a><span class="sd">            The second element is either the Reaction object on success, or a string with an error message on failure.</span>
</span><span id="SentMessage-614"><a href="#SentMessage-614"><span class="linenos">614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-615"><a href="#SentMessage-615"><span class="linenos">615</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="SentMessage-616"><a href="#SentMessage-616"><span class="linenos">616</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">react</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="SentMessage-617"><a href="#SentMessage-617"><span class="linenos">617</span></a>
</span><span id="SentMessage-618"><a href="#SentMessage-618"><span class="linenos">618</span></a>        <span class="c1"># Type check emoji:</span>
</span><span id="SentMessage-619"><a href="#SentMessage-619"><span class="linenos">619</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SentMessage-620"><a href="#SentMessage-620"><span class="linenos">620</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage-621"><a href="#SentMessage-621"><span class="linenos">621</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s1">&#39;emoji&#39;</span><span class="p">,</span> <span class="s2">&quot;str, len = 1 or 2&quot;</span><span class="p">,</span> <span class="n">emoji</span><span class="p">)</span>
</span><span id="SentMessage-622"><a href="#SentMessage-622"><span class="linenos">622</span></a>
</span><span id="SentMessage-623"><a href="#SentMessage-623"><span class="linenos">623</span></a>        <span class="c1"># Value check emoji:</span>
</span><span id="SentMessage-624"><a href="#SentMessage-624"><span class="linenos">624</span></a>        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">emoji</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="SentMessage-625"><a href="#SentMessage-625"><span class="linenos">625</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;emoji must be str of len 1 -&gt; 4&quot;</span>
</span><span id="SentMessage-626"><a href="#SentMessage-626"><span class="linenos">626</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising ValueError(</span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage-627"><a href="#SentMessage-627"><span class="linenos">627</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage-628"><a href="#SentMessage-628"><span class="linenos">628</span></a>
</span><span id="SentMessage-629"><a href="#SentMessage-629"><span class="linenos">629</span></a>        <span class="c1"># Create reaction</span>
</span><span id="SentMessage-630"><a href="#SentMessage-630"><span class="linenos">630</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span><span class="p">:</span>
</span><span id="SentMessage-631"><a href="#SentMessage-631"><span class="linenos">631</span></a>            <span class="n">reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage-632"><a href="#SentMessage-632"><span class="linenos">632</span></a>                                <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage-633"><a href="#SentMessage-633"><span class="linenos">633</span></a>                                <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage-634"><a href="#SentMessage-634"><span class="linenos">634</span></a>                                <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">recipient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span>
</span><span id="SentMessage-635"><a href="#SentMessage-635"><span class="linenos">635</span></a>                                <span class="n">target_author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span>
</span><span id="SentMessage-636"><a href="#SentMessage-636"><span class="linenos">636</span></a>                                <span class="n">target_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</span><span id="SentMessage-637"><a href="#SentMessage-637"><span class="linenos">637</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span><span class="p">:</span>
</span><span id="SentMessage-638"><a href="#SentMessage-638"><span class="linenos">638</span></a>            <span class="n">reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage-639"><a href="#SentMessage-639"><span class="linenos">639</span></a>                                <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage-640"><a href="#SentMessage-640"><span class="linenos">640</span></a>                                <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage-641"><a href="#SentMessage-641"><span class="linenos">641</span></a>                                <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">recipient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span>
</span><span id="SentMessage-642"><a href="#SentMessage-642"><span class="linenos">642</span></a>                                <span class="n">target_author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">target_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</span><span id="SentMessage-643"><a href="#SentMessage-643"><span class="linenos">643</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage-644"><a href="#SentMessage-644"><span class="linenos">644</span></a>            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Invalid recipient type.&quot;</span>
</span><span id="SentMessage-645"><a href="#SentMessage-645"><span class="linenos">645</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_message</span>
</span><span id="SentMessage-646"><a href="#SentMessage-646"><span class="linenos">646</span></a>
</span><span id="SentMessage-647"><a href="#SentMessage-647"><span class="linenos">647</span></a>        <span class="c1"># Send reaction:</span>
</span><span id="SentMessage-648"><a href="#SentMessage-648"><span class="linenos">648</span></a>        <span class="n">sent</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</span><span id="SentMessage-649"><a href="#SentMessage-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sent</span><span class="p">:</span>
</span><span id="SentMessage-650"><a href="#SentMessage-650"><span class="linenos">650</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">message</span>
</span><span id="SentMessage-651"><a href="#SentMessage-651"><span class="linenos">651</span></a>
</span><span id="SentMessage-652"><a href="#SentMessage-652"><span class="linenos">652</span></a>        <span class="c1"># Parse reaction:</span>
</span><span id="SentMessage-653"><a href="#SentMessage-653"><span class="linenos">653</span></a>        <span class="n">parsed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">__parse__</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</span><span id="SentMessage-654"><a href="#SentMessage-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">parsed</span><span class="p">:</span>
</span><span id="SentMessage-655"><a href="#SentMessage-655"><span class="linenos">655</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;failed to parse reaction.&quot;</span>
</span><span id="SentMessage-656"><a href="#SentMessage-656"><span class="linenos">656</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising RuntimeError(</span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage-657"><a href="#SentMessage-657"><span class="linenos">657</span></a>
</span><span id="SentMessage-658"><a href="#SentMessage-658"><span class="linenos">658</span></a>        <span class="c1"># Return success:</span>
</span><span id="SentMessage-659"><a href="#SentMessage-659"><span class="linenos">659</span></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">reaction</span>
</span><span id="SentMessage-660"><a href="#SentMessage-660"><span class="linenos">660</span></a>
</span><span id="SentMessage-661"><a href="#SentMessage-661"><span class="linenos">661</span></a>    <span class="k">def</span> <span class="nf">reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SentMessage-662"><a href="#SentMessage-662"><span class="linenos">662</span></a>              <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-663"><a href="#SentMessage-663"><span class="linenos">663</span></a>              <span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Attachment</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Attachment</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-664"><a href="#SentMessage-664"><span class="linenos">664</span></a>              <span class="n">mentions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">|</span> <span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-665"><a href="#SentMessage-665"><span class="linenos">665</span></a>              <span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-666"><a href="#SentMessage-666"><span class="linenos">666</span></a>              <span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Preview</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage-667"><a href="#SentMessage-667"><span class="linenos">667</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Contact</span> <span class="o">|</span> <span class="n">Group</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Self</span><span class="p">],</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="SentMessage-668"><a href="#SentMessage-668"><span class="linenos">668</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage-669"><a href="#SentMessage-669"><span class="linenos">669</span></a><span class="sd">        Send a reply to this message.</span>
</span><span id="SentMessage-670"><a href="#SentMessage-670"><span class="linenos">670</span></a><span class="sd">        :param body: str: The body to reply with.</span>
</span><span id="SentMessage-671"><a href="#SentMessage-671"><span class="linenos">671</span></a><span class="sd">        :param attachments: Optional[Iterable[Attachment | str] | Attachment | str]: Any attachments to the message.</span>
</span><span id="SentMessage-672"><a href="#SentMessage-672"><span class="linenos">672</span></a><span class="sd">        :param mentions: Optional[Iterable[Mention] | Mentions | Mention]: Any mentions in this message.</span>
</span><span id="SentMessage-673"><a href="#SentMessage-673"><span class="linenos">673</span></a><span class="sd">        :param sticker: Optional[Sticker]: The sticker to send as a message.</span>
</span><span id="SentMessage-674"><a href="#SentMessage-674"><span class="linenos">674</span></a><span class="sd">        :param preview: Optional[Preview]: Any URL preview for this message.</span>
</span><span id="SentMessage-675"><a href="#SentMessage-675"><span class="linenos">675</span></a><span class="sd">        :return: tuple[tuple[bool, Contact | Group, str | SentMessage], ...]: A tuple of tuples. One inner tuple per</span>
</span><span id="SentMessage-676"><a href="#SentMessage-676"><span class="linenos">676</span></a><span class="sd">            recipient of the message.</span>
</span><span id="SentMessage-677"><a href="#SentMessage-677"><span class="linenos">677</span></a><span class="sd">            The first element of the inner tuple is a bool which is True or False on success or failure.</span>
</span><span id="SentMessage-678"><a href="#SentMessage-678"><span class="linenos">678</span></a><span class="sd">            The second element of the inner tuple is the Contact or Group that this message was sent to.</span>
</span><span id="SentMessage-679"><a href="#SentMessage-679"><span class="linenos">679</span></a><span class="sd">            The third element of the inner tuple is either the SentMessage object on success or an error message on</span>
</span><span id="SentMessage-680"><a href="#SentMessage-680"><span class="linenos">680</span></a><span class="sd">            failure.</span>
</span><span id="SentMessage-681"><a href="#SentMessage-681"><span class="linenos">681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage-682"><a href="#SentMessage-682"><span class="linenos">682</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Class to store a sent message.</p>
</div>


                            <div id="SentMessage.__init__" class="classattr">
                                        <input id="SentMessage.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SentMessage</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">command_socket</span><span class="p">:</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span>,</span><span class="param">	<span class="n">account_id</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">contacts</span><span class="p">:</span> <span class="n"><a href="signalContacts.html#Contacts">SignalCliApi.signalContacts.Contacts</a></span>,</span><span class="param">	<span class="n">groups</span><span class="p">:</span> <span class="n"><a href="signalGroups.html#Groups">SignalCliApi.signalGroups.Groups</a></span>,</span><span class="param">	<span class="n">devices</span><span class="p">:</span> <span class="n"><a href="signalDevices.html#Devices">SignalCliApi.signalDevices.Devices</a></span>,</span><span class="param">	<span class="n">this_device</span><span class="p">:</span> <span class="n"><a href="signalDevice.html#Device">SignalCliApi.signalDevice.Device</a></span>,</span><span class="param">	<span class="n">sticker_packs</span><span class="p">:</span> <span class="n"><a href="signalSticker.html#StickerPacks">SignalCliApi.signalSticker.StickerPacks</a></span>,</span><span class="param">	<span class="n">from_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">raw_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">recipient</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="signalContact.html#Contact">SignalCliApi.signalContact.Contact</a></span><span class="p">,</span> <span class="n"><a href="signalGroup.html#Group">SignalCliApi.signalGroup.Group</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="signalTimestamp.html#Timestamp">SignalCliApi.signalTimestamp.Timestamp</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">attachments</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="signalAttachment.html#Attachment">SignalCliApi.signalAttachment.Attachment</a></span><span class="p">],</span> <span class="n"><a href="signalAttachment.html#Attachment">SignalCliApi.signalAttachment.Attachment</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mentions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="signalMention.html#Mention">SignalCliApi.signalMention.Mention</a></span><span class="p">],</span> <span class="n"><a href="signalMentions.html#Mentions">SignalCliApi.signalMentions.Mentions</a></span><span class="p">,</span> <span class="n"><a href="signalMention.html#Mention">SignalCliApi.signalMention.Mention</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">reactions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="signalReaction.html#Reaction">SignalCliApi.signalReaction.Reaction</a></span><span class="p">],</span> <span class="n"><a href="signalReactions.html#Reactions">SignalCliApi.signalReactions.Reactions</a></span><span class="p">,</span> <span class="n"><a href="signalReaction.html#Reaction">SignalCliApi.signalReaction.Reaction</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="signalSticker.html#Sticker">SignalCliApi.signalSticker.Sticker</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="signalQuote.html#Quote">SignalCliApi.signalQuote.Quote</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">sent_to</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="signalContact.html#Contact">SignalCliApi.signalContact.Contact</a></span><span class="p">],</span> <span class="n"><a href="signalContact.html#Contact">SignalCliApi.signalContact.Contact</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="signalPreview.html#Preview">SignalCliApi.signalPreview.Preview</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="SentMessage.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SentMessage.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SentMessage.__init__-39"><a href="#SentMessage.__init__-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SentMessage.__init__-40"><a href="#SentMessage.__init__-40"><span class="linenos"> 40</span></a>                 <span class="n">command_socket</span><span class="p">:</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">,</span>
</span><span id="SentMessage.__init__-41"><a href="#SentMessage.__init__-41"><span class="linenos"> 41</span></a>                 <span class="n">account_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="SentMessage.__init__-42"><a href="#SentMessage.__init__-42"><span class="linenos"> 42</span></a>                 <span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="SentMessage.__init__-43"><a href="#SentMessage.__init__-43"><span class="linenos"> 43</span></a>                 <span class="n">contacts</span><span class="p">:</span> <span class="n">Contacts</span><span class="p">,</span>
</span><span id="SentMessage.__init__-44"><a href="#SentMessage.__init__-44"><span class="linenos"> 44</span></a>                 <span class="n">groups</span><span class="p">:</span> <span class="n">Groups</span><span class="p">,</span>
</span><span id="SentMessage.__init__-45"><a href="#SentMessage.__init__-45"><span class="linenos"> 45</span></a>                 <span class="n">devices</span><span class="p">:</span> <span class="n">Devices</span><span class="p">,</span>
</span><span id="SentMessage.__init__-46"><a href="#SentMessage.__init__-46"><span class="linenos"> 46</span></a>                 <span class="n">this_device</span><span class="p">:</span> <span class="n">Device</span><span class="p">,</span>
</span><span id="SentMessage.__init__-47"><a href="#SentMessage.__init__-47"><span class="linenos"> 47</span></a>                 <span class="n">sticker_packs</span><span class="p">:</span> <span class="n">StickerPacks</span><span class="p">,</span>
</span><span id="SentMessage.__init__-48"><a href="#SentMessage.__init__-48"><span class="linenos"> 48</span></a>                 <span class="n">from_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-49"><a href="#SentMessage.__init__-49"><span class="linenos"> 49</span></a>                 <span class="n">raw_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-50"><a href="#SentMessage.__init__-50"><span class="linenos"> 50</span></a>                 <span class="n">recipient</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Contact</span> <span class="o">|</span> <span class="n">Group</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-51"><a href="#SentMessage.__init__-51"><span class="linenos"> 51</span></a>                 <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-52"><a href="#SentMessage.__init__-52"><span class="linenos"> 52</span></a>                 <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-53"><a href="#SentMessage.__init__-53"><span class="linenos"> 53</span></a>                 <span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]</span> <span class="o">|</span> <span class="n">Attachment</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-54"><a href="#SentMessage.__init__-54"><span class="linenos"> 54</span></a>                 <span class="n">mentions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">|</span> <span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-55"><a href="#SentMessage.__init__-55"><span class="linenos"> 55</span></a>                 <span class="n">reactions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">|</span> <span class="n">Reactions</span> <span class="o">|</span> <span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-56"><a href="#SentMessage.__init__-56"><span class="linenos"> 56</span></a>                 <span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-57"><a href="#SentMessage.__init__-57"><span class="linenos"> 57</span></a>                 <span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quote</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-58"><a href="#SentMessage.__init__-58"><span class="linenos"> 58</span></a>                 <span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-59"><a href="#SentMessage.__init__-59"><span class="linenos"> 59</span></a>                 <span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="SentMessage.__init__-60"><a href="#SentMessage.__init__-60"><span class="linenos"> 60</span></a>                 <span class="n">sent_to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Contact</span><span class="p">]</span> <span class="o">|</span> <span class="n">Contact</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-61"><a href="#SentMessage.__init__-61"><span class="linenos"> 61</span></a>                 <span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Preview</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.__init__-62"><a href="#SentMessage.__init__-62"><span class="linenos"> 62</span></a>                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-63"><a href="#SentMessage.__init__-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-64"><a href="#SentMessage.__init__-64"><span class="linenos"> 64</span></a><span class="sd">        Initialize a SentMessage object.</span>
</span><span id="SentMessage.__init__-65"><a href="#SentMessage.__init__-65"><span class="linenos"> 65</span></a><span class="sd">        :param command_socket: socket.socket: The socket to use for command operations.</span>
</span><span id="SentMessage.__init__-66"><a href="#SentMessage.__init__-66"><span class="linenos"> 66</span></a><span class="sd">        :param account_id: str: This accounts&#39; ID.</span>
</span><span id="SentMessage.__init__-67"><a href="#SentMessage.__init__-67"><span class="linenos"> 67</span></a><span class="sd">        :param config_path: str: The full path to signal-cli config directory.</span>
</span><span id="SentMessage.__init__-68"><a href="#SentMessage.__init__-68"><span class="linenos"> 68</span></a><span class="sd">        :param contacts: Contacts: This accounts&#39; Contacts object.</span>
</span><span id="SentMessage.__init__-69"><a href="#SentMessage.__init__-69"><span class="linenos"> 69</span></a><span class="sd">        :param groups: Groups: This accounts&#39; Groups object.</span>
</span><span id="SentMessage.__init__-70"><a href="#SentMessage.__init__-70"><span class="linenos"> 70</span></a><span class="sd">        :param devices: Devices: This accounts&#39; Devices object.</span>
</span><span id="SentMessage.__init__-71"><a href="#SentMessage.__init__-71"><span class="linenos"> 71</span></a><span class="sd">        :param this_device: Device: The Device object representing the device we&#39;re on.</span>
</span><span id="SentMessage.__init__-72"><a href="#SentMessage.__init__-72"><span class="linenos"> 72</span></a><span class="sd">        :param sticker_packs: StickerPacks: The loaded StickerPacks object.</span>
</span><span id="SentMessage.__init__-73"><a href="#SentMessage.__init__-73"><span class="linenos"> 73</span></a><span class="sd">        :param from_dict: Optional[dict[str, Any]]: The dict created by __to_dict__().</span>
</span><span id="SentMessage.__init__-74"><a href="#SentMessage.__init__-74"><span class="linenos"> 74</span></a><span class="sd">        :param raw_message: Optional[dict[str, Any]]: The dict provided by signal.</span>
</span><span id="SentMessage.__init__-75"><a href="#SentMessage.__init__-75"><span class="linenos"> 75</span></a><span class="sd">        :param recipient: Optional[Contact | Group]: The recipient of this message.</span>
</span><span id="SentMessage.__init__-76"><a href="#SentMessage.__init__-76"><span class="linenos"> 76</span></a><span class="sd">        :param timestamp: Optional[Timestamp]: The timestamp of this message.</span>
</span><span id="SentMessage.__init__-77"><a href="#SentMessage.__init__-77"><span class="linenos"> 77</span></a><span class="sd">        :param body: Optional[str]: The body of this message.</span>
</span><span id="SentMessage.__init__-78"><a href="#SentMessage.__init__-78"><span class="linenos"> 78</span></a><span class="sd">        :param attachments: Optional[Iterable[Attachment] | Attachment]: Any attachments to this message.</span>
</span><span id="SentMessage.__init__-79"><a href="#SentMessage.__init__-79"><span class="linenos"> 79</span></a><span class="sd">        :param mentions: Optional[Iterable[Mention] | Mentions | Mention]: Any mentions in this message.</span>
</span><span id="SentMessage.__init__-80"><a href="#SentMessage.__init__-80"><span class="linenos"> 80</span></a><span class="sd">        :param reactions: Optional[Iterable[Reaction] | Reactions | Reaction]: Any reactions to this message.</span>
</span><span id="SentMessage.__init__-81"><a href="#SentMessage.__init__-81"><span class="linenos"> 81</span></a><span class="sd">        :param sticker: Optional[Sticker]: The sticker for this message.</span>
</span><span id="SentMessage.__init__-82"><a href="#SentMessage.__init__-82"><span class="linenos"> 82</span></a><span class="sd">        :param quote: Optional[Quote]: The quote this message contains.</span>
</span><span id="SentMessage.__init__-83"><a href="#SentMessage.__init__-83"><span class="linenos"> 83</span></a><span class="sd">        :param expiration: Optional[timedelta]: The expiration time in seconds as a timedelta.</span>
</span><span id="SentMessage.__init__-84"><a href="#SentMessage.__init__-84"><span class="linenos"> 84</span></a><span class="sd">        :param is_sent: bool: Is this message already sent?</span>
</span><span id="SentMessage.__init__-85"><a href="#SentMessage.__init__-85"><span class="linenos"> 85</span></a><span class="sd">        :param sent_to: Optional[Iterable[Contact] | Contact]: The Contacts of the people this message was sent to, if</span>
</span><span id="SentMessage.__init__-86"><a href="#SentMessage.__init__-86"><span class="linenos"> 86</span></a><span class="sd">            the message was sent to a Group, the members of the group will show up here individually.</span>
</span><span id="SentMessage.__init__-87"><a href="#SentMessage.__init__-87"><span class="linenos"> 87</span></a><span class="sd">        :param preview: Optional[Preview]: Any URL preview this message contains.</span>
</span><span id="SentMessage.__init__-88"><a href="#SentMessage.__init__-88"><span class="linenos"> 88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-89"><a href="#SentMessage.__init__-89"><span class="linenos"> 89</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="SentMessage.__init__-90"><a href="#SentMessage.__init__-90"><span class="linenos"> 90</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="SentMessage.__init__-91"><a href="#SentMessage.__init__-91"><span class="linenos"> 91</span></a>
</span><span id="SentMessage.__init__-92"><a href="#SentMessage.__init__-92"><span class="linenos"> 92</span></a>        <span class="c1"># Check sticker_packs:</span>
</span><span id="SentMessage.__init__-93"><a href="#SentMessage.__init__-93"><span class="linenos"> 93</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sticker_packs</span><span class="p">,</span> <span class="n">StickerPacks</span><span class="p">):</span>
</span><span id="SentMessage.__init__-94"><a href="#SentMessage.__init__-94"><span class="linenos"> 94</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-95"><a href="#SentMessage.__init__-95"><span class="linenos"> 95</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sticker_packs&quot;</span><span class="p">,</span> <span class="s2">&quot;StickerPacks&quot;</span><span class="p">,</span> <span class="n">sticker_packs</span><span class="p">)</span>
</span><span id="SentMessage.__init__-96"><a href="#SentMessage.__init__-96"><span class="linenos"> 96</span></a>
</span><span id="SentMessage.__init__-97"><a href="#SentMessage.__init__-97"><span class="linenos"> 97</span></a>        <span class="c1"># Check Body:</span>
</span><span id="SentMessage.__init__-98"><a href="#SentMessage.__init__-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SentMessage.__init__-99"><a href="#SentMessage.__init__-99"><span class="linenos"> 99</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-100"><a href="#SentMessage.__init__-100"><span class="linenos">100</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[str]&quot;</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</span><span id="SentMessage.__init__-101"><a href="#SentMessage.__init__-101"><span class="linenos">101</span></a>
</span><span id="SentMessage.__init__-102"><a href="#SentMessage.__init__-102"><span class="linenos">102</span></a>        <span class="c1"># Check attachments:</span>
</span><span id="SentMessage.__init__-103"><a href="#SentMessage.__init__-103"><span class="linenos">103</span></a>        <span class="n">attachment_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-104"><a href="#SentMessage.__init__-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="n">attachments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-105"><a href="#SentMessage.__init__-105"><span class="linenos">105</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachments</span><span class="p">,</span> <span class="n">Attachment</span><span class="p">):</span>
</span><span id="SentMessage.__init__-106"><a href="#SentMessage.__init__-106"><span class="linenos">106</span></a>                <span class="n">attachment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachments</span><span class="p">)</span>
</span><span id="SentMessage.__init__-107"><a href="#SentMessage.__init__-107"><span class="linenos">107</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachments</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage.__init__-108"><a href="#SentMessage.__init__-108"><span class="linenos">108</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attachments</span><span class="p">):</span>
</span><span id="SentMessage.__init__-109"><a href="#SentMessage.__init__-109"><span class="linenos">109</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attachment</span><span class="p">,</span> <span class="n">Attachment</span><span class="p">):</span>
</span><span id="SentMessage.__init__-110"><a href="#SentMessage.__init__-110"><span class="linenos">110</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-111"><a href="#SentMessage.__init__-111"><span class="linenos">111</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;attachments[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Attachment&quot;</span><span class="p">,</span> <span class="n">attachment</span><span class="p">)</span>
</span><span id="SentMessage.__init__-112"><a href="#SentMessage.__init__-112"><span class="linenos">112</span></a>                    <span class="n">attachment_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
</span><span id="SentMessage.__init__-113"><a href="#SentMessage.__init__-113"><span class="linenos">113</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-114"><a href="#SentMessage.__init__-114"><span class="linenos">114</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-115"><a href="#SentMessage.__init__-115"><span class="linenos">115</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;attachments&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Attachment] | Attachment&quot;</span><span class="p">,</span> <span class="n">attachments</span><span class="p">)</span>
</span><span id="SentMessage.__init__-116"><a href="#SentMessage.__init__-116"><span class="linenos">116</span></a>
</span><span id="SentMessage.__init__-117"><a href="#SentMessage.__init__-117"><span class="linenos">117</span></a>        <span class="c1"># Check mentions:</span>
</span><span id="SentMessage.__init__-118"><a href="#SentMessage.__init__-118"><span class="linenos">118</span></a>        <span class="n">mentions_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-119"><a href="#SentMessage.__init__-119"><span class="linenos">119</span></a>        <span class="k">if</span> <span class="n">mentions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-120"><a href="#SentMessage.__init__-120"><span class="linenos">120</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mentions</span><span class="p">):</span>
</span><span id="SentMessage.__init__-121"><a href="#SentMessage.__init__-121"><span class="linenos">121</span></a>                <span class="k">pass</span>  <span class="c1"># This is checked again later.</span>
</span><span id="SentMessage.__init__-122"><a href="#SentMessage.__init__-122"><span class="linenos">122</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mention</span><span class="p">):</span>
</span><span id="SentMessage.__init__-123"><a href="#SentMessage.__init__-123"><span class="linenos">123</span></a>                <span class="n">mentions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mentions</span><span class="p">)</span>
</span><span id="SentMessage.__init__-124"><a href="#SentMessage.__init__-124"><span class="linenos">124</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage.__init__-125"><a href="#SentMessage.__init__-125"><span class="linenos">125</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mention</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mentions</span><span class="p">):</span>
</span><span id="SentMessage.__init__-126"><a href="#SentMessage.__init__-126"><span class="linenos">126</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mention</span><span class="p">,</span> <span class="n">Mention</span><span class="p">):</span>
</span><span id="SentMessage.__init__-127"><a href="#SentMessage.__init__-127"><span class="linenos">127</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-128"><a href="#SentMessage.__init__-128"><span class="linenos">128</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;mentions[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Mention&quot;</span><span class="p">,</span> <span class="n">mention</span><span class="p">)</span>
</span><span id="SentMessage.__init__-129"><a href="#SentMessage.__init__-129"><span class="linenos">129</span></a>                    <span class="n">mentions_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mention</span><span class="p">)</span>
</span><span id="SentMessage.__init__-130"><a href="#SentMessage.__init__-130"><span class="linenos">130</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-131"><a href="#SentMessage.__init__-131"><span class="linenos">131</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-132"><a href="#SentMessage.__init__-132"><span class="linenos">132</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;mentions&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Mention] | Mentions | Mention]&quot;</span><span class="p">,</span> <span class="n">mentions</span><span class="p">)</span>
</span><span id="SentMessage.__init__-133"><a href="#SentMessage.__init__-133"><span class="linenos">133</span></a>
</span><span id="SentMessage.__init__-134"><a href="#SentMessage.__init__-134"><span class="linenos">134</span></a>        <span class="c1"># Check reactions:</span>
</span><span id="SentMessage.__init__-135"><a href="#SentMessage.__init__-135"><span class="linenos">135</span></a>        <span class="n">reaction_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-136"><a href="#SentMessage.__init__-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="n">reactions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-137"><a href="#SentMessage.__init__-137"><span class="linenos">137</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reactions</span><span class="p">):</span>
</span><span id="SentMessage.__init__-138"><a href="#SentMessage.__init__-138"><span class="linenos">138</span></a>                <span class="k">pass</span>  <span class="c1"># This is checked again later.</span>
</span><span id="SentMessage.__init__-139"><a href="#SentMessage.__init__-139"><span class="linenos">139</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
</span><span id="SentMessage.__init__-140"><a href="#SentMessage.__init__-140"><span class="linenos">140</span></a>                <span class="n">reaction_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reactions</span><span class="p">)</span>
</span><span id="SentMessage.__init__-141"><a href="#SentMessage.__init__-141"><span class="linenos">141</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage.__init__-142"><a href="#SentMessage.__init__-142"><span class="linenos">142</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reactions</span><span class="p">):</span>
</span><span id="SentMessage.__init__-143"><a href="#SentMessage.__init__-143"><span class="linenos">143</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">):</span>
</span><span id="SentMessage.__init__-144"><a href="#SentMessage.__init__-144"><span class="linenos">144</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-145"><a href="#SentMessage.__init__-145"><span class="linenos">145</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s1">&#39;reactions[</span><span class="si">%i</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Reaction&quot;</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
</span><span id="SentMessage.__init__-146"><a href="#SentMessage.__init__-146"><span class="linenos">146</span></a>                    <span class="n">reaction_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</span><span id="SentMessage.__init__-147"><a href="#SentMessage.__init__-147"><span class="linenos">147</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-148"><a href="#SentMessage.__init__-148"><span class="linenos">148</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-149"><a href="#SentMessage.__init__-149"><span class="linenos">149</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;reactions&quot;</span><span class="p">,</span> <span class="s2">&quot;Optional[Iterable[Reaction] | Reactions | Reaction&quot;</span><span class="p">,</span> <span class="n">reactions</span><span class="p">)</span>
</span><span id="SentMessage.__init__-150"><a href="#SentMessage.__init__-150"><span class="linenos">150</span></a>
</span><span id="SentMessage.__init__-151"><a href="#SentMessage.__init__-151"><span class="linenos">151</span></a>        <span class="c1"># Check sticker:</span>
</span><span id="SentMessage.__init__-152"><a href="#SentMessage.__init__-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="n">sticker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sticker</span><span class="p">,</span> <span class="n">Sticker</span><span class="p">):</span>
</span><span id="SentMessage.__init__-153"><a href="#SentMessage.__init__-153"><span class="linenos">153</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-154"><a href="#SentMessage.__init__-154"><span class="linenos">154</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sticker&quot;</span><span class="p">,</span> <span class="s2">&quot;Sticker&quot;</span><span class="p">,</span> <span class="n">sticker</span><span class="p">)</span>
</span><span id="SentMessage.__init__-155"><a href="#SentMessage.__init__-155"><span class="linenos">155</span></a>
</span><span id="SentMessage.__init__-156"><a href="#SentMessage.__init__-156"><span class="linenos">156</span></a>        <span class="c1"># Check quote:</span>
</span><span id="SentMessage.__init__-157"><a href="#SentMessage.__init__-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">quote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quote</span><span class="p">,</span> <span class="n">Quote</span><span class="p">):</span>
</span><span id="SentMessage.__init__-158"><a href="#SentMessage.__init__-158"><span class="linenos">158</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-159"><a href="#SentMessage.__init__-159"><span class="linenos">159</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;quote&quot;</span><span class="p">,</span> <span class="s2">&quot;Quote&quot;</span><span class="p">,</span> <span class="n">quote</span><span class="p">)</span>
</span><span id="SentMessage.__init__-160"><a href="#SentMessage.__init__-160"><span class="linenos">160</span></a>
</span><span id="SentMessage.__init__-161"><a href="#SentMessage.__init__-161"><span class="linenos">161</span></a>        <span class="c1"># Check expiry:</span>
</span><span id="SentMessage.__init__-162"><a href="#SentMessage.__init__-162"><span class="linenos">162</span></a>        <span class="k">if</span> <span class="n">expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-163"><a href="#SentMessage.__init__-163"><span class="linenos">163</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expiration</span><span class="p">,</span> <span class="n">timedelta</span><span class="p">):</span>
</span><span id="SentMessage.__init__-164"><a href="#SentMessage.__init__-164"><span class="linenos">164</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-165"><a href="#SentMessage.__init__-165"><span class="linenos">165</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;expiry&quot;</span><span class="p">,</span> <span class="s2">&quot;timedelta&quot;</span><span class="p">,</span> <span class="n">expiration</span><span class="p">)</span>
</span><span id="SentMessage.__init__-166"><a href="#SentMessage.__init__-166"><span class="linenos">166</span></a>
</span><span id="SentMessage.__init__-167"><a href="#SentMessage.__init__-167"><span class="linenos">167</span></a>        <span class="c1"># Check is_sent:</span>
</span><span id="SentMessage.__init__-168"><a href="#SentMessage.__init__-168"><span class="linenos">168</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">is_sent</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="SentMessage.__init__-169"><a href="#SentMessage.__init__-169"><span class="linenos">169</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;is_sent&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">,</span> <span class="n">is_sent</span><span class="p">)</span>
</span><span id="SentMessage.__init__-170"><a href="#SentMessage.__init__-170"><span class="linenos">170</span></a>
</span><span id="SentMessage.__init__-171"><a href="#SentMessage.__init__-171"><span class="linenos">171</span></a>        <span class="c1"># Check sent_to:</span>
</span><span id="SentMessage.__init__-172"><a href="#SentMessage.__init__-172"><span class="linenos">172</span></a>        <span class="n">sent_to_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Contact</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage.__init__-173"><a href="#SentMessage.__init__-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">sent_to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-174"><a href="#SentMessage.__init__-174"><span class="linenos">174</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_to</span><span class="p">,</span> <span class="n">Contact</span><span class="p">):</span>
</span><span id="SentMessage.__init__-175"><a href="#SentMessage.__init__-175"><span class="linenos">175</span></a>                <span class="n">sent_to_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent_to</span><span class="p">]</span>
</span><span id="SentMessage.__init__-176"><a href="#SentMessage.__init__-176"><span class="linenos">176</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sent_to</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="SentMessage.__init__-177"><a href="#SentMessage.__init__-177"><span class="linenos">177</span></a>                <span class="n">sent_to_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-178"><a href="#SentMessage.__init__-178"><span class="linenos">178</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">contact</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sent_to_list</span><span class="p">):</span>
</span><span id="SentMessage.__init__-179"><a href="#SentMessage.__init__-179"><span class="linenos">179</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="n">Contact</span><span class="p">):</span>
</span><span id="SentMessage.__init__-180"><a href="#SentMessage.__init__-180"><span class="linenos">180</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-181"><a href="#SentMessage.__init__-181"><span class="linenos">181</span></a>                        <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sent_to[</span><span class="si">%i</span><span class="s2">]&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;Contact&quot;</span><span class="p">,</span> <span class="n">contact</span><span class="p">)</span>
</span><span id="SentMessage.__init__-182"><a href="#SentMessage.__init__-182"><span class="linenos">182</span></a>                    <span class="n">sent_to_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contact</span><span class="p">)</span>
</span><span id="SentMessage.__init__-183"><a href="#SentMessage.__init__-183"><span class="linenos">183</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-184"><a href="#SentMessage.__init__-184"><span class="linenos">184</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-185"><a href="#SentMessage.__init__-185"><span class="linenos">185</span></a>                <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;sent_to&quot;</span><span class="p">,</span> <span class="s2">&quot;Iterable[Contact] | Contact&quot;</span><span class="p">,</span> <span class="n">sent_to</span><span class="p">)</span>
</span><span id="SentMessage.__init__-186"><a href="#SentMessage.__init__-186"><span class="linenos">186</span></a>
</span><span id="SentMessage.__init__-187"><a href="#SentMessage.__init__-187"><span class="linenos">187</span></a>        <span class="c1"># Check previews:</span>
</span><span id="SentMessage.__init__-188"><a href="#SentMessage.__init__-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="n">preview</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">preview</span><span class="p">,</span> <span class="n">Preview</span><span class="p">):</span>
</span><span id="SentMessage.__init__-189"><a href="#SentMessage.__init__-189"><span class="linenos">189</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.__init__-190"><a href="#SentMessage.__init__-190"><span class="linenos">190</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">,</span> <span class="s2">&quot;Preview&quot;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>
</span><span id="SentMessage.__init__-191"><a href="#SentMessage.__init__-191"><span class="linenos">191</span></a>
</span><span id="SentMessage.__init__-192"><a href="#SentMessage.__init__-192"><span class="linenos">192</span></a>        <span class="c1"># Set internal vars:</span>
</span><span id="SentMessage.__init__-193"><a href="#SentMessage.__init__-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sticker_packs</span> <span class="o">=</span> <span class="n">sticker_packs</span>
</span><span id="SentMessage.__init__-194"><a href="#SentMessage.__init__-194"><span class="linenos">194</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The loaded sticker packs object.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-195"><a href="#SentMessage.__init__-195"><span class="linenos">195</span></a>
</span><span id="SentMessage.__init__-196"><a href="#SentMessage.__init__-196"><span class="linenos">196</span></a>        <span class="c1"># Set external properties:</span>
</span><span id="SentMessage.__init__-197"><a href="#SentMessage.__init__-197"><span class="linenos">197</span></a>        <span class="c1"># Set body:</span>
</span><span id="SentMessage.__init__-198"><a href="#SentMessage.__init__-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span>
</span><span id="SentMessage.__init__-199"><a href="#SentMessage.__init__-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The body of the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-200"><a href="#SentMessage.__init__-200"><span class="linenos">200</span></a>        <span class="c1"># Set Attachments:</span>
</span><span id="SentMessage.__init__-201"><a href="#SentMessage.__init__-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Attachment</span><span class="p">]]</span>
</span><span id="SentMessage.__init__-202"><a href="#SentMessage.__init__-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any attachments to the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-203"><a href="#SentMessage.__init__-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attachment_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage.__init__-204"><a href="#SentMessage.__init__-204"><span class="linenos">204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage.__init__-205"><a href="#SentMessage.__init__-205"><span class="linenos">205</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-206"><a href="#SentMessage.__init__-206"><span class="linenos">206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">attachments</span> <span class="o">=</span> <span class="n">attachment_list</span>
</span><span id="SentMessage.__init__-207"><a href="#SentMessage.__init__-207"><span class="linenos">207</span></a>        <span class="c1"># Set mentions:</span>
</span><span id="SentMessage.__init__-208"><a href="#SentMessage.__init__-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="p">:</span> <span class="n">Mentions</span>
</span><span id="SentMessage.__init__-209"><a href="#SentMessage.__init__-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any mentions in the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-210"><a href="#SentMessage.__init__-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mentions</span><span class="p">,</span> <span class="n">Mentions</span><span class="p">):</span>
</span><span id="SentMessage.__init__-211"><a href="#SentMessage.__init__-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">mentions</span>
</span><span id="SentMessage.__init__-212"><a href="#SentMessage.__init__-212"><span class="linenos">212</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">mentions_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage.__init__-213"><a href="#SentMessage.__init__-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">)</span>
</span><span id="SentMessage.__init__-214"><a href="#SentMessage.__init__-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-215"><a href="#SentMessage.__init__-215"><span class="linenos">215</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="o">=</span> <span class="n">Mentions</span><span class="p">(</span><span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">mentions</span><span class="o">=</span><span class="n">mentions_list</span><span class="p">)</span>
</span><span id="SentMessage.__init__-216"><a href="#SentMessage.__init__-216"><span class="linenos">216</span></a>        <span class="c1"># Set reactions:</span>
</span><span id="SentMessage.__init__-217"><a href="#SentMessage.__init__-217"><span class="linenos">217</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span> <span class="n">Reactions</span>
</span><span id="SentMessage.__init__-218"><a href="#SentMessage.__init__-218"><span class="linenos">218</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any reactions to the message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-219"><a href="#SentMessage.__init__-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reactions</span><span class="p">,</span> <span class="n">Reactions</span><span class="p">):</span>
</span><span id="SentMessage.__init__-220"><a href="#SentMessage.__init__-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">reactions</span>
</span><span id="SentMessage.__init__-221"><a href="#SentMessage.__init__-221"><span class="linenos">221</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">reaction_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="SentMessage.__init__-222"><a href="#SentMessage.__init__-222"><span class="linenos">222</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
</span><span id="SentMessage.__init__-223"><a href="#SentMessage.__init__-223"><span class="linenos">223</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="SentMessage.__init__-224"><a href="#SentMessage.__init__-224"><span class="linenos">224</span></a>                                       <span class="n">this_device</span><span class="o">=</span><span class="n">this_device</span><span class="p">)</span>
</span><span id="SentMessage.__init__-225"><a href="#SentMessage.__init__-225"><span class="linenos">225</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.__init__-226"><a href="#SentMessage.__init__-226"><span class="linenos">226</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="n">Reactions</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span>
</span><span id="SentMessage.__init__-227"><a href="#SentMessage.__init__-227"><span class="linenos">227</span></a>                                       <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="n">devices</span><span class="p">,</span>
</span><span id="SentMessage.__init__-228"><a href="#SentMessage.__init__-228"><span class="linenos">228</span></a>                                       <span class="n">this_device</span><span class="o">=</span><span class="n">this_device</span><span class="p">,</span> <span class="n">reactions</span><span class="o">=</span><span class="n">reaction_list</span><span class="p">)</span>
</span><span id="SentMessage.__init__-229"><a href="#SentMessage.__init__-229"><span class="linenos">229</span></a>        <span class="c1"># Set sticker:</span>
</span><span id="SentMessage.__init__-230"><a href="#SentMessage.__init__-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="n">sticker</span>
</span><span id="SentMessage.__init__-231"><a href="#SentMessage.__init__-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The sticker for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-232"><a href="#SentMessage.__init__-232"><span class="linenos">232</span></a>        <span class="c1"># Set quote:</span>
</span><span id="SentMessage.__init__-233"><a href="#SentMessage.__init__-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quote</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quote</span><span class="p">]</span> <span class="o">=</span> <span class="n">quote</span>
</span><span id="SentMessage.__init__-234"><a href="#SentMessage.__init__-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The quote this message contains.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-235"><a href="#SentMessage.__init__-235"><span class="linenos">235</span></a>        <span class="c1"># Set expiry:</span>
</span><span id="SentMessage.__init__-236"><a href="#SentMessage.__init__-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="n">expiration</span>
</span><span id="SentMessage.__init__-237"><a href="#SentMessage.__init__-237"><span class="linenos">237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The expiration time of this message in seconds as a timedelta.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-238"><a href="#SentMessage.__init__-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">expiration_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timestamp</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SentMessage.__init__-239"><a href="#SentMessage.__init__-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The timestamp at which this message expires.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-240"><a href="#SentMessage.__init__-240"><span class="linenos">240</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_expired</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="SentMessage.__init__-241"><a href="#SentMessage.__init__-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Is this message expired?&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-242"><a href="#SentMessage.__init__-242"><span class="linenos">242</span></a>        <span class="c1"># Set is sent:</span>
</span><span id="SentMessage.__init__-243"><a href="#SentMessage.__init__-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_sent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_sent</span>
</span><span id="SentMessage.__init__-244"><a href="#SentMessage.__init__-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Was this message sent?&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-245"><a href="#SentMessage.__init__-245"><span class="linenos">245</span></a>        <span class="c1"># Set sent_to:</span>
</span><span id="SentMessage.__init__-246"><a href="#SentMessage.__init__-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Contact</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-247"><a href="#SentMessage.__init__-247"><span class="linenos">247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List of Contacts of who this message has been sent to.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-248"><a href="#SentMessage.__init__-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="n">sent_to_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.__init__-249"><a href="#SentMessage.__init__-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sent_to</span> <span class="o">=</span> <span class="n">sent_to_list</span>
</span><span id="SentMessage.__init__-250"><a href="#SentMessage.__init__-250"><span class="linenos">250</span></a>        <span class="c1"># Set delivery_receipts, read_receipts and viewed_receipts:</span>
</span><span id="SentMessage.__init__-251"><a href="#SentMessage.__init__-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">delivery_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-252"><a href="#SentMessage.__init__-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The delivery receipts for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-253"><a href="#SentMessage.__init__-253"><span class="linenos">253</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">read_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-254"><a href="#SentMessage.__init__-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The read receipts for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-255"><a href="#SentMessage.__init__-255"><span class="linenos">255</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">viewed_receipts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Receipt</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="SentMessage.__init__-256"><a href="#SentMessage.__init__-256"><span class="linenos">256</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;The viewed receipts for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-257"><a href="#SentMessage.__init__-257"><span class="linenos">257</span></a>        <span class="c1"># Set previews:</span>
</span><span id="SentMessage.__init__-258"><a href="#SentMessage.__init__-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preview</span><span class="p">:</span> <span class="n">Preview</span> <span class="o">=</span> <span class="n">preview</span>
</span><span id="SentMessage.__init__-259"><a href="#SentMessage.__init__-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Any URL previews for this message.&quot;&quot;&quot;</span>
</span><span id="SentMessage.__init__-260"><a href="#SentMessage.__init__-260"><span class="linenos">260</span></a>
</span><span id="SentMessage.__init__-261"><a href="#SentMessage.__init__-261"><span class="linenos">261</span></a>        <span class="c1"># Run super init:</span>
</span><span id="SentMessage.__init__-262"><a href="#SentMessage.__init__-262"><span class="linenos">262</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">this_device</span><span class="p">,</span> <span class="n">from_dict</span><span class="p">,</span>
</span><span id="SentMessage.__init__-263"><a href="#SentMessage.__init__-263"><span class="linenos">263</span></a>                         <span class="n">raw_message</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">get_self</span><span class="p">(),</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">this_device</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">MessageTypes</span><span class="o">.</span><span class="n">SENT</span><span class="p">)</span>
</span><span id="SentMessage.__init__-264"><a href="#SentMessage.__init__-264"><span class="linenos">264</span></a>
</span><span id="SentMessage.__init__-265"><a href="#SentMessage.__init__-265"><span class="linenos">265</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a SentMessage object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>command_socket: socket.socket</strong>:  The socket to use for command operations.</li>
<li><strong>account_id: str</strong>:  This accounts' ID.</li>
<li><strong>config_path: str</strong>:  The full path to signal-cli config directory.</li>
<li><strong>contacts: Contacts</strong>:  This accounts' Contacts object.</li>
<li><strong>groups: Groups</strong>:  This accounts' Groups object.</li>
<li><strong>devices: Devices</strong>:  This accounts' Devices object.</li>
<li><strong>this_device: Device</strong>:  The Device object representing the device we're on.</li>
<li><strong>sticker_packs: StickerPacks</strong>:  The loaded StickerPacks object.</li>
<li><strong>from_dict: Optional[dict[str, Any]]</strong>:  The dict created by __to_dict__().</li>
<li><strong>raw_message: Optional[dict[str, Any]]</strong>:  The dict provided by signal.</li>
<li><strong>recipient: Optional[Contact | Group]</strong>:  The recipient of this message.</li>
<li><strong>timestamp: Optional[Timestamp]</strong>:  The timestamp of this message.</li>
<li><strong>body: Optional[str]</strong>:  The body of this message.</li>
<li><strong>attachments: Optional[Iterable[Attachment] | Attachment]</strong>:  Any attachments to this message.</li>
<li><strong>mentions: Optional[Iterable[Mention] | Mentions | Mention]</strong>:  Any mentions in this message.</li>
<li><strong>reactions: Optional[Iterable[Reaction] | Reactions | Reaction]</strong>:  Any reactions to this message.</li>
<li><strong>sticker: Optional[Sticker]</strong>:  The sticker for this message.</li>
<li><strong>quote: Optional[Quote]</strong>:  The quote this message contains.</li>
<li><strong>expiration: Optional[timedelta]</strong>:  The expiration time in seconds as a timedelta.</li>
<li><strong>is_sent: bool</strong>:  Is this message already sent?</li>
<li><strong>sent_to: Optional[Iterable[Contact] | Contact]</strong>:  The Contacts of the people this message was sent to, if
the message was sent to a Group, the members of the group will show up here individually.</li>
<li><strong>preview: Optional[Preview]</strong>:  Any URL preview this message contains.</li>
</ul>
</div>


                            </div>
                            <div id="SentMessage.body" class="classattr">
                                <div class="attr variable">
            <span class="name">body</span><span class="annotation">: Optional[str]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.body"></a>
    
            <div class="docstring"><p>The body of the message.</p>
</div>


                            </div>
                            <div id="SentMessage.attachments" class="classattr">
                                <div class="attr variable">
            <span class="name">attachments</span><span class="annotation">: Optional[list[<a href="signalAttachment.html#Attachment">SignalCliApi.signalAttachment.Attachment</a>]]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.attachments"></a>
    
            <div class="docstring"><p>Any attachments to the message.</p>
</div>


                            </div>
                            <div id="SentMessage.mentions" class="classattr">
                                <div class="attr variable">
            <span class="name">mentions</span><span class="annotation">: <a href="signalMentions.html#Mentions">SignalCliApi.signalMentions.Mentions</a></span>

        
    </div>
    <a class="headerlink" href="#SentMessage.mentions"></a>
    
            <div class="docstring"><p>Any mentions in the message.</p>
</div>


                            </div>
                            <div id="SentMessage.reactions" class="classattr">
                                <div class="attr variable">
            <span class="name">reactions</span><span class="annotation">: <a href="signalReactions.html#Reactions">SignalCliApi.signalReactions.Reactions</a></span>

        
    </div>
    <a class="headerlink" href="#SentMessage.reactions"></a>
    
            <div class="docstring"><p>Any reactions to the message.</p>
</div>


                            </div>
                            <div id="SentMessage.sticker" class="classattr">
                                <div class="attr variable">
            <span class="name">sticker</span><span class="annotation">: Optional[<a href="signalSticker.html#Sticker">SignalCliApi.signalSticker.Sticker</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.sticker"></a>
    
            <div class="docstring"><p>The sticker for this message.</p>
</div>


                            </div>
                            <div id="SentMessage.quote" class="classattr">
                                <div class="attr variable">
            <span class="name">quote</span><span class="annotation">: Optional[<a href="signalQuote.html#Quote">SignalCliApi.signalQuote.Quote</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.quote"></a>
    
            <div class="docstring"><p>The quote this message contains.</p>
</div>


                            </div>
                            <div id="SentMessage.expiration" class="classattr">
                                <div class="attr variable">
            <span class="name">expiration</span><span class="annotation">: Optional[datetime.timedelta]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.expiration"></a>
    
            <div class="docstring"><p>The expiration time of this message in seconds as a timedelta.</p>
</div>


                            </div>
                            <div id="SentMessage.expiration_timestamp" class="classattr">
                                <div class="attr variable">
            <span class="name">expiration_timestamp</span><span class="annotation">: Optional[<a href="signalTimestamp.html#Timestamp">SignalCliApi.signalTimestamp.Timestamp</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.expiration_timestamp"></a>
    
            <div class="docstring"><p>The timestamp at which this message expires.</p>
</div>


                            </div>
                            <div id="SentMessage.is_expired" class="classattr">
                                <div class="attr variable">
            <span class="name">is_expired</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.is_expired"></a>
    
            <div class="docstring"><p>Is this message expired?</p>
</div>


                            </div>
                            <div id="SentMessage.is_sent" class="classattr">
                                <div class="attr variable">
            <span class="name">is_sent</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.is_sent"></a>
    
            <div class="docstring"><p>Was this message sent?</p>
</div>


                            </div>
                            <div id="SentMessage.sent_to" class="classattr">
                                <div class="attr variable">
            <span class="name">sent_to</span><span class="annotation">: list[<a href="signalContact.html#Contact">SignalCliApi.signalContact.Contact</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.sent_to"></a>
    
            <div class="docstring"><p>List of Contacts of who this message has been sent to.</p>
</div>


                            </div>
                            <div id="SentMessage.delivery_receipts" class="classattr">
                                <div class="attr variable">
            <span class="name">delivery_receipts</span><span class="annotation">: list[<a href="signalReceipt.html#Receipt">SignalCliApi.signalReceipt.Receipt</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.delivery_receipts"></a>
    
            <div class="docstring"><p>The delivery receipts for this message.</p>
</div>


                            </div>
                            <div id="SentMessage.read_receipts" class="classattr">
                                <div class="attr variable">
            <span class="name">read_receipts</span><span class="annotation">: list[<a href="signalReceipt.html#Receipt">SignalCliApi.signalReceipt.Receipt</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.read_receipts"></a>
    
            <div class="docstring"><p>The read receipts for this message.</p>
</div>


                            </div>
                            <div id="SentMessage.viewed_receipts" class="classattr">
                                <div class="attr variable">
            <span class="name">viewed_receipts</span><span class="annotation">: list[<a href="signalReceipt.html#Receipt">SignalCliApi.signalReceipt.Receipt</a>]</span>

        
    </div>
    <a class="headerlink" href="#SentMessage.viewed_receipts"></a>
    
            <div class="docstring"><p>The viewed receipts for this message.</p>
</div>


                            </div>
                            <div id="SentMessage.preview" class="classattr">
                                <div class="attr variable">
            <span class="name">preview</span><span class="annotation">: <a href="signalPreview.html#Preview">SignalCliApi.signalPreview.Preview</a></span>

        
    </div>
    <a class="headerlink" href="#SentMessage.preview"></a>
    
            <div class="docstring"><p>Any URL previews for this message.</p>
</div>


                            </div>
                            <div id="SentMessage.get_quote" class="classattr">
                                        <input id="SentMessage.get_quote-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_quote</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="signalQuote.html#Quote">SignalCliApi.signalQuote.Quote</a></span>:</span></span>

                <label class="view-source-button" for="SentMessage.get_quote-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SentMessage.get_quote"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SentMessage.get_quote-588"><a href="#SentMessage.get_quote-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">get_quote</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Quote</span><span class="p">:</span>
</span><span id="SentMessage.get_quote-589"><a href="#SentMessage.get_quote-589"><span class="linenos">589</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage.get_quote-590"><a href="#SentMessage.get_quote-590"><span class="linenos">590</span></a><span class="sd">        Get a quote object for this message.</span>
</span><span id="SentMessage.get_quote-591"><a href="#SentMessage.get_quote-591"><span class="linenos">591</span></a><span class="sd">        :return: Quote: This message as a Quote object.</span>
</span><span id="SentMessage.get_quote-592"><a href="#SentMessage.get_quote-592"><span class="linenos">592</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage.get_quote-593"><a href="#SentMessage.get_quote-593"><span class="linenos">593</span></a>        <span class="n">quote</span> <span class="o">=</span> <span class="n">Quote</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span> <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span>
</span><span id="SentMessage.get_quote-594"><a href="#SentMessage.get_quote-594"><span class="linenos">594</span></a>                      <span class="n">timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">mentions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="p">,</span>
</span><span id="SentMessage.get_quote-595"><a href="#SentMessage.get_quote-595"><span class="linenos">595</span></a>                      <span class="n">conversation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">)</span>
</span><span id="SentMessage.get_quote-596"><a href="#SentMessage.get_quote-596"><span class="linenos">596</span></a>        <span class="k">return</span> <span class="n">quote</span>
</span></pre></div>


            <div class="docstring"><p>Get a quote object for this message.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Quote: This message as a Quote object.</p>
</blockquote>
</div>


                            </div>
                            <div id="SentMessage.parse_mentions" class="classattr">
                                        <input id="SentMessage.parse_mentions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_mentions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="SentMessage.parse_mentions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SentMessage.parse_mentions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SentMessage.parse_mentions-598"><a href="#SentMessage.parse_mentions-598"><span class="linenos">598</span></a>    <span class="k">def</span> <span class="nf">parse_mentions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="SentMessage.parse_mentions-599"><a href="#SentMessage.parse_mentions-599"><span class="linenos">599</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage.parse_mentions-600"><a href="#SentMessage.parse_mentions-600"><span class="linenos">600</span></a><span class="sd">        Parse mentions in this message.</span>
</span><span id="SentMessage.parse_mentions-601"><a href="#SentMessage.parse_mentions-601"><span class="linenos">601</span></a><span class="sd">        :return: str: The body with mentions parsed; If &#39;mentions&#39; is None, the original body is returned.</span>
</span><span id="SentMessage.parse_mentions-602"><a href="#SentMessage.parse_mentions-602"><span class="linenos">602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage.parse_mentions-603"><a href="#SentMessage.parse_mentions-603"><span class="linenos">603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SentMessage.parse_mentions-604"><a href="#SentMessage.parse_mentions-604"><span class="linenos">604</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span>
</span><span id="SentMessage.parse_mentions-605"><a href="#SentMessage.parse_mentions-605"><span class="linenos">605</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mentions</span><span class="o">.</span><span class="n">__parse_mentions__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parse mentions in this message.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>str: The body with mentions parsed; If 'mentions' is None, the original body is returned.</p>
</blockquote>
</div>


                            </div>
                            <div id="SentMessage.react" class="classattr">
                                        <input id="SentMessage.react-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">react</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">emoji</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n"><a href="signalReaction.html#Reaction">SignalCliApi.signalReaction.Reaction</a></span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="SentMessage.react-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SentMessage.react"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SentMessage.react-607"><a href="#SentMessage.react-607"><span class="linenos">607</span></a>    <span class="k">def</span> <span class="nf">react</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">emoji</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Reaction</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="SentMessage.react-608"><a href="#SentMessage.react-608"><span class="linenos">608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage.react-609"><a href="#SentMessage.react-609"><span class="linenos">609</span></a><span class="sd">        Send a reaction to this message.</span>
</span><span id="SentMessage.react-610"><a href="#SentMessage.react-610"><span class="linenos">610</span></a><span class="sd">        :param emoji: str: The emoji to react with.</span>
</span><span id="SentMessage.react-611"><a href="#SentMessage.react-611"><span class="linenos">611</span></a><span class="sd">        :return: tuple[bool, Reaction | str]: The first element is a bool which is either True or False on success or</span>
</span><span id="SentMessage.react-612"><a href="#SentMessage.react-612"><span class="linenos">612</span></a><span class="sd">            failure.</span>
</span><span id="SentMessage.react-613"><a href="#SentMessage.react-613"><span class="linenos">613</span></a><span class="sd">            The second element is either the Reaction object on success, or a string with an error message on failure.</span>
</span><span id="SentMessage.react-614"><a href="#SentMessage.react-614"><span class="linenos">614</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage.react-615"><a href="#SentMessage.react-615"><span class="linenos">615</span></a>        <span class="c1"># Setup logging:</span>
</span><span id="SentMessage.react-616"><a href="#SentMessage.react-616"><span class="linenos">616</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">react</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="SentMessage.react-617"><a href="#SentMessage.react-617"><span class="linenos">617</span></a>
</span><span id="SentMessage.react-618"><a href="#SentMessage.react-618"><span class="linenos">618</span></a>        <span class="c1"># Type check emoji:</span>
</span><span id="SentMessage.react-619"><a href="#SentMessage.react-619"><span class="linenos">619</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">emoji</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="SentMessage.react-620"><a href="#SentMessage.react-620"><span class="linenos">620</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising TypeError:&quot;</span><span class="p">)</span>
</span><span id="SentMessage.react-621"><a href="#SentMessage.react-621"><span class="linenos">621</span></a>            <span class="n">__type_error__</span><span class="p">(</span><span class="s1">&#39;emoji&#39;</span><span class="p">,</span> <span class="s2">&quot;str, len = 1 or 2&quot;</span><span class="p">,</span> <span class="n">emoji</span><span class="p">)</span>
</span><span id="SentMessage.react-622"><a href="#SentMessage.react-622"><span class="linenos">622</span></a>
</span><span id="SentMessage.react-623"><a href="#SentMessage.react-623"><span class="linenos">623</span></a>        <span class="c1"># Value check emoji:</span>
</span><span id="SentMessage.react-624"><a href="#SentMessage.react-624"><span class="linenos">624</span></a>        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">emoji</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="SentMessage.react-625"><a href="#SentMessage.react-625"><span class="linenos">625</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;emoji must be str of len 1 -&gt; 4&quot;</span>
</span><span id="SentMessage.react-626"><a href="#SentMessage.react-626"><span class="linenos">626</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising ValueError(</span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage.react-627"><a href="#SentMessage.react-627"><span class="linenos">627</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage.react-628"><a href="#SentMessage.react-628"><span class="linenos">628</span></a>
</span><span id="SentMessage.react-629"><a href="#SentMessage.react-629"><span class="linenos">629</span></a>        <span class="c1"># Create reaction</span>
</span><span id="SentMessage.react-630"><a href="#SentMessage.react-630"><span class="linenos">630</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">CONTACT</span><span class="p">:</span>
</span><span id="SentMessage.react-631"><a href="#SentMessage.react-631"><span class="linenos">631</span></a>            <span class="n">reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage.react-632"><a href="#SentMessage.react-632"><span class="linenos">632</span></a>                                <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage.react-633"><a href="#SentMessage.react-633"><span class="linenos">633</span></a>                                <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage.react-634"><a href="#SentMessage.react-634"><span class="linenos">634</span></a>                                <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">recipient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span>
</span><span id="SentMessage.react-635"><a href="#SentMessage.react-635"><span class="linenos">635</span></a>                                <span class="n">target_author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span>
</span><span id="SentMessage.react-636"><a href="#SentMessage.react-636"><span class="linenos">636</span></a>                                <span class="n">target_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</span><span id="SentMessage.react-637"><a href="#SentMessage.react-637"><span class="linenos">637</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipient_type</span> <span class="o">==</span> <span class="n">RecipientTypes</span><span class="o">.</span><span class="n">GROUP</span><span class="p">:</span>
</span><span id="SentMessage.react-638"><a href="#SentMessage.react-638"><span class="linenos">638</span></a>            <span class="n">reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">command_socket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_socket</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_account_id</span><span class="p">,</span>
</span><span id="SentMessage.react-639"><a href="#SentMessage.react-639"><span class="linenos">639</span></a>                                <span class="n">config_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_path</span><span class="p">,</span>
</span><span id="SentMessage.react-640"><a href="#SentMessage.react-640"><span class="linenos">640</span></a>                                <span class="n">contacts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_contacts</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_groups</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_devices</span><span class="p">,</span>
</span><span id="SentMessage.react-641"><a href="#SentMessage.react-641"><span class="linenos">641</span></a>                                <span class="n">this_device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_this_device</span><span class="p">,</span> <span class="n">recipient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">,</span> <span class="n">emoji</span><span class="o">=</span><span class="n">emoji</span><span class="p">,</span>
</span><span id="SentMessage.react-642"><a href="#SentMessage.react-642"><span class="linenos">642</span></a>                                <span class="n">target_author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">target_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
</span><span id="SentMessage.react-643"><a href="#SentMessage.react-643"><span class="linenos">643</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SentMessage.react-644"><a href="#SentMessage.react-644"><span class="linenos">644</span></a>            <span class="n">error_message</span> <span class="o">=</span> <span class="s2">&quot;Invalid recipient type.&quot;</span>
</span><span id="SentMessage.react-645"><a href="#SentMessage.react-645"><span class="linenos">645</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_message</span>
</span><span id="SentMessage.react-646"><a href="#SentMessage.react-646"><span class="linenos">646</span></a>
</span><span id="SentMessage.react-647"><a href="#SentMessage.react-647"><span class="linenos">647</span></a>        <span class="c1"># Send reaction:</span>
</span><span id="SentMessage.react-648"><a href="#SentMessage.react-648"><span class="linenos">648</span></a>        <span class="n">sent</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</span><span id="SentMessage.react-649"><a href="#SentMessage.react-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">sent</span><span class="p">:</span>
</span><span id="SentMessage.react-650"><a href="#SentMessage.react-650"><span class="linenos">650</span></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">message</span>
</span><span id="SentMessage.react-651"><a href="#SentMessage.react-651"><span class="linenos">651</span></a>
</span><span id="SentMessage.react-652"><a href="#SentMessage.react-652"><span class="linenos">652</span></a>        <span class="c1"># Parse reaction:</span>
</span><span id="SentMessage.react-653"><a href="#SentMessage.react-653"><span class="linenos">653</span></a>        <span class="n">parsed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">__parse__</span><span class="p">(</span><span class="n">reaction</span><span class="p">)</span>
</span><span id="SentMessage.react-654"><a href="#SentMessage.react-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">parsed</span><span class="p">:</span>
</span><span id="SentMessage.react-655"><a href="#SentMessage.react-655"><span class="linenos">655</span></a>            <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;failed to parse reaction.&quot;</span>
</span><span id="SentMessage.react-656"><a href="#SentMessage.react-656"><span class="linenos">656</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s2">&quot;Raising RuntimeError(</span><span class="si">%s</span><span class="s2">).&quot;</span> <span class="o">%</span> <span class="n">error_message</span><span class="p">)</span>
</span><span id="SentMessage.react-657"><a href="#SentMessage.react-657"><span class="linenos">657</span></a>
</span><span id="SentMessage.react-658"><a href="#SentMessage.react-658"><span class="linenos">658</span></a>        <span class="c1"># Return success:</span>
</span><span id="SentMessage.react-659"><a href="#SentMessage.react-659"><span class="linenos">659</span></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">reaction</span>
</span></pre></div>


            <div class="docstring"><p>Send a reaction to this message.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>emoji: str</strong>:  The emoji to react with.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>tuple[bool, Reaction | str]: The first element is a bool which is either True or False on success or
      failure.
      The second element is either the Reaction object on success, or a string with an error message on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="SentMessage.reply" class="classattr">
                                        <input id="SentMessage.reply-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reply</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">attachments</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="signalAttachment.html#Attachment">SignalCliApi.signalAttachment.Attachment</a></span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span> <span class="n"><a href="signalAttachment.html#Attachment">SignalCliApi.signalAttachment.Attachment</a></span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mentions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n"><a href="signalMention.html#Mention">SignalCliApi.signalMention.Mention</a></span><span class="p">],</span> <span class="n"><a href="signalMentions.html#Mentions">SignalCliApi.signalMentions.Mentions</a></span><span class="p">,</span> <span class="n"><a href="signalMention.html#Mention">SignalCliApi.signalMention.Mention</a></span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="signalSticker.html#Sticker">SignalCliApi.signalSticker.Sticker</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="signalPreview.html#Preview">SignalCliApi.signalPreview.Preview</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n"><a href="signalContact.html#Contact">SignalCliApi.signalContact.Contact</a></span> <span class="o">|</span> <span class="n"><a href="signalGroup.html#Group">SignalCliApi.signalGroup.Group</a></span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">~</span><span class="n">Self</span><span class="p">]],</span> <span class="o">...</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="SentMessage.reply-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SentMessage.reply"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SentMessage.reply-661"><a href="#SentMessage.reply-661"><span class="linenos">661</span></a>    <span class="k">def</span> <span class="nf">reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="SentMessage.reply-662"><a href="#SentMessage.reply-662"><span class="linenos">662</span></a>              <span class="n">body</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.reply-663"><a href="#SentMessage.reply-663"><span class="linenos">663</span></a>              <span class="n">attachments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Attachment</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Attachment</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.reply-664"><a href="#SentMessage.reply-664"><span class="linenos">664</span></a>              <span class="n">mentions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mentions</span> <span class="o">|</span> <span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.reply-665"><a href="#SentMessage.reply-665"><span class="linenos">665</span></a>              <span class="n">sticker</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sticker</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.reply-666"><a href="#SentMessage.reply-666"><span class="linenos">666</span></a>              <span class="n">preview</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Preview</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SentMessage.reply-667"><a href="#SentMessage.reply-667"><span class="linenos">667</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Contact</span> <span class="o">|</span> <span class="n">Group</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Self</span><span class="p">],</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="SentMessage.reply-668"><a href="#SentMessage.reply-668"><span class="linenos">668</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="SentMessage.reply-669"><a href="#SentMessage.reply-669"><span class="linenos">669</span></a><span class="sd">        Send a reply to this message.</span>
</span><span id="SentMessage.reply-670"><a href="#SentMessage.reply-670"><span class="linenos">670</span></a><span class="sd">        :param body: str: The body to reply with.</span>
</span><span id="SentMessage.reply-671"><a href="#SentMessage.reply-671"><span class="linenos">671</span></a><span class="sd">        :param attachments: Optional[Iterable[Attachment | str] | Attachment | str]: Any attachments to the message.</span>
</span><span id="SentMessage.reply-672"><a href="#SentMessage.reply-672"><span class="linenos">672</span></a><span class="sd">        :param mentions: Optional[Iterable[Mention] | Mentions | Mention]: Any mentions in this message.</span>
</span><span id="SentMessage.reply-673"><a href="#SentMessage.reply-673"><span class="linenos">673</span></a><span class="sd">        :param sticker: Optional[Sticker]: The sticker to send as a message.</span>
</span><span id="SentMessage.reply-674"><a href="#SentMessage.reply-674"><span class="linenos">674</span></a><span class="sd">        :param preview: Optional[Preview]: Any URL preview for this message.</span>
</span><span id="SentMessage.reply-675"><a href="#SentMessage.reply-675"><span class="linenos">675</span></a><span class="sd">        :return: tuple[tuple[bool, Contact | Group, str | SentMessage], ...]: A tuple of tuples. One inner tuple per</span>
</span><span id="SentMessage.reply-676"><a href="#SentMessage.reply-676"><span class="linenos">676</span></a><span class="sd">            recipient of the message.</span>
</span><span id="SentMessage.reply-677"><a href="#SentMessage.reply-677"><span class="linenos">677</span></a><span class="sd">            The first element of the inner tuple is a bool which is True or False on success or failure.</span>
</span><span id="SentMessage.reply-678"><a href="#SentMessage.reply-678"><span class="linenos">678</span></a><span class="sd">            The second element of the inner tuple is the Contact or Group that this message was sent to.</span>
</span><span id="SentMessage.reply-679"><a href="#SentMessage.reply-679"><span class="linenos">679</span></a><span class="sd">            The third element of the inner tuple is either the SentMessage object on success or an error message on</span>
</span><span id="SentMessage.reply-680"><a href="#SentMessage.reply-680"><span class="linenos">680</span></a><span class="sd">            failure.</span>
</span><span id="SentMessage.reply-681"><a href="#SentMessage.reply-681"><span class="linenos">681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SentMessage.reply-682"><a href="#SentMessage.reply-682"><span class="linenos">682</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Send a reply to this message.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>body: str</strong>:  The body to reply with.</li>
<li><strong>attachments: Optional[Iterable[Attachment | str] | Attachment | str]</strong>:  Any attachments to the message.</li>
<li><strong>mentions: Optional[Iterable[Mention] | Mentions | Mention]</strong>:  Any mentions in this message.</li>
<li><strong>sticker: Optional[Sticker]</strong>:  The sticker to send as a message.</li>
<li><strong>preview: Optional[Preview]</strong>:  Any URL preview for this message.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>tuple[tuple[bool, Contact | Group, str | SentMessage], ...]: A tuple of tuples. One inner tuple per
      recipient of the message.
      The first element of the inner tuple is a bool which is True or False on success or failure.
      The second element of the inner tuple is the Contact or Group that this message was sent to.
      The third element of the inner tuple is either the SentMessage object on success or an error message on
      failure.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="signalMessage.html#Message">SignalCliApi.signalMessage.Message</a></dt>
                                <dd id="SentMessage.sender" class="variable"><a href="signalMessage.html#Message.sender">sender</a></dd>
                <dd id="SentMessage.recipient" class="variable"><a href="signalMessage.html#Message.recipient">recipient</a></dd>
                <dd id="SentMessage.recipient_type" class="variable"><a href="signalMessage.html#Message.recipient_type">recipient_type</a></dd>
                <dd id="SentMessage.device" class="variable"><a href="signalMessage.html#Message.device">device</a></dd>
                <dd id="SentMessage.timestamp" class="variable"><a href="signalMessage.html#Message.timestamp">timestamp</a></dd>
                <dd id="SentMessage.message_type" class="variable"><a href="signalMessage.html#Message.message_type">message_type</a></dd>
                <dd id="SentMessage.is_delivered" class="variable"><a href="signalMessage.html#Message.is_delivered">is_delivered</a></dd>
                <dd id="SentMessage.time_delivered" class="variable"><a href="signalMessage.html#Message.time_delivered">time_delivered</a></dd>
                <dd id="SentMessage.is_read" class="variable"><a href="signalMessage.html#Message.is_read">is_read</a></dd>
                <dd id="SentMessage.time_read" class="variable"><a href="signalMessage.html#Message.time_read">time_read</a></dd>
                <dd id="SentMessage.is_viewed" class="variable"><a href="signalMessage.html#Message.is_viewed">is_viewed</a></dd>
                <dd id="SentMessage.time_viewed" class="variable"><a href="signalMessage.html#Message.time_viewed">time_viewed</a></dd>
                <dd id="SentMessage.mark_delivered" class="function"><a href="signalMessage.html#Message.mark_delivered">mark_delivered</a></dd>
                <dd id="SentMessage.mark_read" class="function"><a href="signalMessage.html#Message.mark_read">mark_read</a></dd>
                <dd id="SentMessage.mark_viewed" class="function"><a href="signalMessage.html#Message.mark_viewed">mark_viewed</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>